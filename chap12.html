

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Chapter 12: Divide and Conquer &#8212; Computational Thinking and Problem Solving</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chap12';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapter 13: Rewrite the Error Messages" href="chap13.html" />
    <link rel="prev" title="Chapter 11: Discover Driving Directions" href="chap11.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="ctps.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/mike_flat.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/mike_flat.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="ctps.html">
                    Title Page
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="welcome.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap01.html">Chapter 1: Read a Children’s Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap02.html">Chapter 2: Grab the Dialogue</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap03.html">Chapter 3: Replace Text With Emoji</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap04.html">Chapter 4: Query a Web Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap05.html">Chapter 5: Play Guess-a-number with a Friend</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap06.html">Chapter 6: Do You See My Dog?</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap07.html">Chapter 7: Many Numbers But Not Any Number</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap08.html">Chapter 8: What Is My Problem?</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap09.html">Chapter 9: Find a Phrase</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap10.html">Chapter 10: Build an Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap11.html">Chapter 11: Discover Driving Directions</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 12: Divide and Conquer</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap13.html">Chapter 13: Rewrite the Error Messages</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap14.html">Chapter 14: The Dream of Bug Fixing</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap15.html">Chapter 15: Embrace Runtime Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap16.html">Chapter 16: Catch Them Early</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap17.html">Chapter 17: Build Prediction Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap18.html">Chapter 18: Using Generative AI in Your Life (incomplete)</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="ales.html">Active-Learning Exercises</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="ales-c01.html">Chapter 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="ales-c02.html">Chapter 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="ales-c03.html">Chapter 3</a></li>








<li class="toctree-l2"><a class="reference internal" href="ales-c04.html">Chapter 4</a></li>





<li class="toctree-l2"><a class="reference internal" href="ales-c05.html">Chapter 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="ales-c06.html">Chapter 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="ales-c08.html">Chapter 8</a></li>
<li class="toctree-l2"><a class="reference internal" href="ales-c09.html">Chapter 9</a></li>



<li class="toctree-l2"><a class="reference internal" href="ales-c10.html">Chapter 10</a></li>


</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chap12.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 12: Divide and Conquer</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-specification-for-sorting">A specification for sorting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-in-python">Sorting in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-in-descending-order">Sorting in descending order</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-with-your-own-comparison-function">Sorting with your own comparison function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-playing-cards">Sorting playing cards</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-complexity-of-brute-force-sorting">Time complexity of brute-force sorting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-search">Binary search</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#divide-and-conquer">Divide and conquer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#from-split-to-merge">From split to merge</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iterative-merge-sort">Iterative merge sort</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recursion">Recursion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iterative-factorial">Iterative factorial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recursive-merge-sort">Recursive merge sort</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#beckett-s-challenge">Beckett’s challenge</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#its-base-case">Its base case</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-play-with-a-single-actor">The play with a single actor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#looking-for-the-pattern">Looking for the pattern</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-polished-full-solution">A polished, full solution</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-12-divide-and-conquer">
<h1>Chapter 12: Divide and Conquer<a class="headerlink" href="#chapter-12-divide-and-conquer" title="Permalink to this heading">#</a></h1>
<p>The last chapter ended with a suggestion that we add a heuristic into our goal-directed search algorithm. Without a heuristic, every item on the frontier appears equally good. But with one, our search algorithm explores first the frontier list’s potentially most fruitful item. You can think of the heuristic calculation as solving a simple version of the problem (e.g., which direction would a crow fly to get to our driving goal). While not guaranteed to lead to an optimal solution, good heuristics are fast to compute and likely to prioritize the right frontier items, which can get the search algorithm to a near-optimal solution quickly.</p>
<p>But finding the highest priority item in a list is another kind of search problem. We don’t want to replace the simplicity of an uniformed search (i.e., the appending and popping of items from the ends of the frontier list) with an expensive search of this list, which might make an informed search slower than an uniformed one. To avoid this, informed searches keep the frontier list <em>ordered</em> by priority. And creating such an order is the job of a <em>sorting algorithm</em>.</p>
<p>Sorting appears as a part of many algorithms in computer science, and it makes many of the problems we want solved more efficient and the answers we get more useful. For example, Google sorts its search results before presenting them to the user, since users expect to see the most relevant results at the top of the returned list. In performing this sort, a combination of heuristics are used to assign a score to each returned result (e.g., a person in a particular geographic location probably desires results in that geographic location more than other locations). To similarly aid us in quickly finding that which we care about, the words in a book index are sorted alphabetically.</p>
<div class="admonition-you-try-it admonition">
<p class="admonition-title">You Try It</p>
<p>Think about your daily life and identify three or four other examples of places where things are sorted for your convenience.</p>
</div>
<p>Because of the importance of sorting, it’s another well-studied computational problem. While modern programming languages provide useful sorting primitives—and we’ll discuss those found in Python—the first third of this chapter develops two different sorting algorithms, which provides you with another opportunity to practice going from a specification to two algorithms with different computational complexities. The more computationally efficient of these introduces a new problem-solving technique, called <em>divide and conquer</em>. It works well when the problem before you can be divided into smaller, similarly structured problems. Sorting is exactly such a problem, and we’ll see how to sort a list of numbers by restating the problem as one in which we separately sort the list’s two halves and then quickly combine the sorted results.</p>
<p>The implementation of this more computationally efficient sorting algorithm also introduces you to a new coding technique called <em>recursion</em>, which is the more natural way to write divide-and-conquer algorithms. You’ll learn to write recursive functions from a recursive specification in the middle third of this chapter.</p>
<p>The chapter’s last third pulls all these ideas together by illustrating how to design a recursive solution for a problem that may not initially appear amenable to a divide-and-conquer approach. This is not easy and takes significant practice, but the simplicity of the solution script is the reward for the hard work.</p>
<div class="admonition-learning-outcomes admonition">
<p class="admonition-title">Learning Outcomes</p>
<p>Learn about divide-and-conquer as a problem-solving technique and recursion as a method for writing such algorithms. Sorting, which can be solved using divide-and-conquer, is a tool we often use (e.g., in our solutions to search). You will code two very different sorting algorithms and learn about Python’s built-in mechanisms for sorting. Because our normal looping mechanisms are not a great way to code divide-and-conquer algorithms, you’ll learn to write recursive functions. Finally, given a problem that at first doesn’t seem amenable to a divide-and-conquer technique, you’ll marvel at the conciseness of recursion to express a solution to this problem. In particular, after completing this chapter, you will be able to:</p>
<ul class="simple">
<li><p>Write a broadly applicable specification for sorting and understand how to extend this specification to cover a wide range of sorting problems [design and CS concepts];</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">sort</span></code> method  on Python lists and the <code class="docutils literal notranslate"><span class="pre">sorted</span></code> built-in function to solve a wide range of sorting problems [programming skills];</p></li>
<li><p>Pass a function as a parameter so that you can specialize the behavior of Python’s sorting functions [programming skills];</p></li>
<li><p>Describe and code a brute-force sorting algorithm called insertion sort, which is probably what you use when sorting the cards you’ve been dealt [CS concepts];</p></li>
<li><p>Understand how splitting work can lead to an efficient solution and code an example of this using binary search [design and CS concepts];</p></li>
<li><p>Employ a divide-and-conquer approach to create a more efficient sorting algorithm, called merge sort [design and CS concepts];</p></li>
<li><p>Code merge sort in iterative and recursive styles [CS concepts and programming skills];</p></li>
<li><p>Describe the key components of a recursive function [design and CS concepts];</p></li>
<li><p>Search for patterns in your problem to see if it might be amenable to a divide-and-conquer approach and recognize the base cases in a recursive implementation [design].</p></li>
</ul>
</div>
<section id="a-specification-for-sorting">
<p><strong>A specification for sorting.</strong> We’ve talked about the importance of sorting and now let’s understand how to create a sorted list from an unsorted one. We begin with a formal specification for sorting:</p>
<aside class="margin sidebar">
<p class="sidebar-title">Reference</p>
<p>I’ve borrowed this definition from an earlier edition of <em>Introduction to Algorithms</em> by Thomas H. Cormen, Charles E. Leiserson, and Ronald L. Rivest [The MIT Press; Cambridge, MA; 1995], p. 2.</p>
</aside>
<p>Given a sequence of <span class="math notranslate nohighlight">\(n\)</span> numbers, <span class="math notranslate nohighlight">\([a1, a2, ..., an]\)</span>, produce an output sequence <span class="math notranslate nohighlight">\([a1', a2', ..., an']\)</span> such that <span class="math notranslate nohighlight">\(a1' &lt;= a2' &lt;= ... &lt;= an'\)</span>.</p>
<p>Does this definition match your intuitive understanding of sorting? If you think about a list of numbers and a desire to reorder these numbers so that the smallest is first in the output list, it probably does.</p>
<p>But what if you wanted to sort the list with the largest number first? The definition still works if we consider <span class="math notranslate nohighlight">\(&lt;=\)</span> to be an ordering operation that we specify and not the less-than-or-equal-to operator. In this way, we can sort a list of numbers or strings in either ascending or descending order simply by providing the ordering operation we want applied.</p>
<p>But still, does this definition cover everything you’ve ever sorted? What about when faculty sort their students by full name? How about when you sort your family from shortest to tallest for the annual family picture? We know that faculty sort students initially by last name and then, if needed, by first, and while our family members aren’t numbers, height is a characteristic we can use to order them. Neither of these “complications” fundamentally changes the work we do to sort. They simply specify the work to be done by the ordering operation or the attribute of the objects we’ll used to sort them.</p>
<p>Hopefully, you agree with me that this extremely short definition does an excellent job of capturing the essence of sorting, even if we might want to adapt this specification to specify how we’d like the sorting comparison done.</p>
</section>
<section id="sorting-in-python">
<p><strong>Sorting in Python.</strong> As an example of how programming languages generalize sort, consider the two functions built into Python:</p>
<aside class="margin sidebar">
<p class="sidebar-title">More Details</p>
<p>To learn more about these sorting functions, please see the helpful page titled <a class="reference external" href="https://docs.python.org/3/howto/sorting.html">“Sorting HOW TO”</a> in the Python documentation.</p>
</aside>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">list</span></code> class contains a <code class="docutils literal notranslate"><span class="pre">sort</span></code> method that sorts a list object in place. The original contents of the list are replaced with the sorted contents.</p></li>
<li><p>The built-in function <code class="docutils literal notranslate"><span class="pre">sorted</span></code> takes an object of an iterable type (e.g., a sequence or a dictionary) and returns a new sorted list. The original object is left unchanged.</p></li>
</ul>
<p>Let’s build ourselves a few unsorted lists so that we can play with these functions. We’ll use the lists <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, and <code class="docutils literal notranslate"><span class="pre">w</span></code> below throughout the rest of this chapter.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">### chap12/unsort.py</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="c1"># Some unsorted lists to use as examples and tests</span>
<span class="linenos">4</span><span class="k">def</span> <span class="nf">unsort</span><span class="p">():</span>
<span class="linenos">5</span>    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="linenos">6</span>    <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;6</span><span class="se">\u2663</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;3</span><span class="se">\u2663</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;2</span><span class="se">\u2660</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;2</span><span class="se">\u2661</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;4</span><span class="se">\u2663</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;6</span><span class="se">\u2662</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;5</span><span class="se">\u2660</span><span class="s1">&#39;</span><span class="p">]</span>
<span class="linenos">7</span>    <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;The&#39;</span><span class="p">,</span> <span class="s1">&#39;sun&#39;</span><span class="p">,</span> <span class="s1">&#39;did&#39;</span><span class="p">,</span> <span class="s1">&#39;not&#39;</span><span class="p">,</span> <span class="s1">&#39;shine&#39;</span><span class="p">,</span>
<span class="linenos">8</span>        <span class="s1">&#39;It&#39;</span><span class="p">,</span> <span class="s1">&#39;was&#39;</span><span class="p">,</span> <span class="s1">&#39;too&#39;</span><span class="p">,</span> <span class="s1">&#39;wet&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="s1">&#39;play&#39;</span><span class="p">]</span>
<span class="linenos">9</span>    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">w</span>
</pre></div>
</div>
<p>Often you can use these two sorting functions without any parameters, as illustrated in the next two code blocks.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">2</span><span class="c1">### chap12/sorting.py</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The `sort` method on Python lists sorts in-place&#39;</span><span class="p">)</span>
<span class="linenos">5</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">unsort</span><span class="p">()</span>
<span class="linenos">6</span><span class="n">a</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="linenos">7</span><span class="n">c</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="linenos">8</span><span class="n">w</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="linenos">9</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;a = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="se">\n</span><span class="s1">c = </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="se">\n</span><span class="s1">w = </span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 9</span><span class="c1">### chap12/sorting.py</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The `sorted` built-in function leaves the input object unchanged&#39;</span><span class="p">)</span>
<span class="linenos">12</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">unsort</span><span class="p">()</span>
<span class="linenos">13</span><span class="n">aa</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="linenos">14</span><span class="n">cc</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="linenos">15</span><span class="n">ww</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="linenos">16</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;aa = </span><span class="si">{</span><span class="n">aa</span><span class="si">}</span><span class="se">\n</span><span class="s1">cc = </span><span class="si">{</span><span class="n">cc</span><span class="si">}</span><span class="se">\n</span><span class="s1">ww = </span><span class="si">{</span><span class="n">ww</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Looking back to Chapter 10, where we built a book index, you’ll see that we used the built-in <code class="docutils literal notranslate"><span class="pre">sorted</span></code> function in a problem-to-be-solved: it sorted our dictionary of word-reference pairs for us. Python dictionaries are iterable objects, and calling <code class="docutils literal notranslate"><span class="pre">sorted</span></code> with a dictionary returns a sorted list of the dictionary’s keys, which was exactly what we wanted to print (see lines 62-65 in <code class="docutils literal notranslate"><span class="pre">chap10/index32.py</span></code>).</p>
<p>These examples work because: (1) the way we expected the list elements and dictionary keys sorted matched these functions’ default action (i.e., sort with the “smallest” item first); and (2) the classes for these iterable objects implement the magic method __lt__, which <code class="docutils literal notranslate"><span class="pre">sort</span></code> and <code class="docutils literal notranslate"><span class="pre">sorted</span></code> use behind the scenes to determine the sorted ordering.</p>
</section>
<section id="sorting-in-descending-order">
<p><strong>Sorting in descending order.</strong> But what if we wanted to sort so that the “largest” item came first? Both <code class="docutils literal notranslate"><span class="pre">sort</span></code> and <code class="docutils literal notranslate"><span class="pre">sorted</span></code> support this behavior through the setting of the named parameter <code class="docutils literal notranslate"><span class="pre">reverse</span></code>. It is <code class="docutils literal notranslate"><span class="pre">False</span></code> by default, but by setting it <code class="docutils literal notranslate"><span class="pre">True</span></code>, the sort is “reversed” from its default. Let’s reverse-sort our example lists to see this in action.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">16</span><span class="c1">### chap12/sorting.py</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The `sort` method reversed&#39;</span><span class="p">)</span>
<span class="linenos">19</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">unsort</span><span class="p">()</span>
<span class="linenos">20</span><span class="n">a</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">21</span><span class="n">c</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">22</span><span class="n">w</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">23</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;a = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="se">\n</span><span class="s1">c = </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="se">\n</span><span class="s1">w = </span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The `sorted` built-in function reversed&#39;</span><span class="p">)</span>
<span class="linenos">26</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">unsort</span><span class="p">()</span>
<span class="linenos">27</span><span class="n">aa</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">28</span><span class="n">cc</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">29</span><span class="n">ww</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">30</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;aa = </span><span class="si">{</span><span class="n">aa</span><span class="si">}</span><span class="se">\n</span><span class="s1">cc = </span><span class="si">{</span><span class="n">cc</span><span class="si">}</span><span class="se">\n</span><span class="s1">ww = </span><span class="si">{</span><span class="n">ww</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sorting-with-your-own-comparison-function">
<p><strong>Sorting with your own comparison function.</strong> But we also talked about more “complicated” sortings that professors do with student names and you do with your relatives for a family picture. The two Python sorting functions handle this type of complicated data through their <code class="docutils literal notranslate"><span class="pre">key</span></code> parameter. It allows you to do things like: (1) sort a list of words without worrying about the capitalization of the words; and (2) sort a list of complex objects using only one or a few of the attributes of the objects.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">key</span></code> parameter takes a function. We know how to define a function and how to call a function, but what does it mean to say that a parameter takes a function? Well, a function is just another Python object, and instead of invoking that function using its name and a pair of parentheses (e.g., <code class="docutils literal notranslate"><span class="pre">str.lower()</span></code>), we can assign a new name to that function by referring to its current name (e.g., <code class="docutils literal notranslate"><span class="pre">also_lower</span> <span class="pre">=</span> <span class="pre">str.lower</span></code>). That’s all that occurs when we pass a function as a parameter (i.e., give the function a new name). So, to sort our unsorted list of words without worrying about each word’s capitalization, we simply write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">30</span><span class="c1">### chap12/sorting.py</span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;`sort` ignoring capitalization&#39;</span><span class="p">)</span>
<span class="linenos">33</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">unsort</span><span class="p">()</span>
<span class="linenos">34</span><span class="n">w_caps</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="linenos">35</span><span class="n">w_nocaps</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span>
<span class="linenos">36</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;w_caps = </span><span class="si">{</span><span class="n">w_caps</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="linenos">37</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;w_nocaps = </span><span class="si">{</span><span class="n">w_nocaps</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Inside the implementation of <code class="docutils literal notranslate"><span class="pre">sort</span></code>, <code class="docutils literal notranslate"><span class="pre">str.lower</span></code> is applied to each item in the input list (i.e., <code class="docutils literal notranslate"><span class="pre">w</span></code>) and the result of this function is the value used in the comparison to determine whether this item comes before or after another item.</p>
<p>But we don’t have to pass to <code class="docutils literal notranslate"><span class="pre">key</span></code> functions that someone else wrote. We can pass the name of a function we’ve written! This will allow us to sort a list of complex objects using only one or a few of the attributes of the objects.</p>
<p>For instance, imagine we have a database of records, where a <em>record</em> is a block of information consisting of many attributes. We’ll build an example of such a database as a simple list, and each list item will be a tuple. The list items are our database records, and the tuple items the values for each record field. Here’s an example of such a database using a set of characteristics about the individuals that were involved in the first class I taught using this book:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">37</span><span class="c1">### chap12/sorting.py</span>
<span class="linenos">38</span>
<span class="linenos">39</span><span class="n">cs32_staff</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">40</span>    <span class="c1"># fields: name, fav_color, fav_animal, batting_avg</span>
<span class="linenos">41</span>    <span class="p">(</span><span class="s1">&#39;Mike&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="mf">0.042</span><span class="p">),</span>
<span class="linenos">42</span>    <span class="p">(</span><span class="s1">&#39;Dhilan&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="s1">&#39;lion&#39;</span><span class="p">,</span> <span class="mf">0.333</span><span class="p">),</span>
<span class="linenos">43</span>    <span class="p">(</span><span class="s1">&#39;Manana&#39;</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;golden eagle&#39;</span><span class="p">,</span> <span class="mf">0.395</span><span class="p">),</span>
<span class="linenos">44</span>    <span class="p">(</span><span class="s1">&#39;Emily&#39;</span><span class="p">,</span> <span class="s1">&#39;forest green&#39;</span><span class="p">,</span> <span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="mf">0.400</span><span class="p">),</span>
<span class="linenos">45</span>    <span class="p">(</span><span class="s1">&#39;Jiahui&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;bear&#39;</span><span class="p">,</span> <span class="mf">0.392</span><span class="p">),</span>
<span class="linenos">46</span>    <span class="p">(</span><span class="s1">&#39;Matthew&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;ram&#39;</span><span class="p">,</span> <span class="mf">0.299</span><span class="p">),</span>
<span class="linenos">47</span>    <span class="p">(</span><span class="s1">&#39;Karly&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;dolphin&#39;</span><span class="p">,</span> <span class="mf">0.315</span><span class="p">),</span>
<span class="linenos">48</span>    <span class="p">(</span><span class="s1">&#39;Sid&#39;</span><span class="p">,</span> <span class="s1">&#39;baby blue&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="mf">0.215</span><span class="p">),</span>
<span class="linenos">49</span>    <span class="p">(</span><span class="s1">&#39;Nadine&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;owl&#39;</span><span class="p">,</span> <span class="mf">0.357</span><span class="p">),</span>
<span class="linenos">50</span>    <span class="p">(</span><span class="s1">&#39;Patrick&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;dragon&#39;</span><span class="p">,</span> <span class="mf">0.278</span><span class="p">),</span>
<span class="linenos">51</span>    <span class="p">(</span><span class="s1">&#39;Cosmo&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;squirrel&#39;</span><span class="p">,</span> <span class="mf">0.043</span><span class="p">),</span>
<span class="linenos">52</span><span class="p">]</span>
</pre></div>
</div>
<p>To sort this list by batting average, we define a function that takes a tuple as found in this database and returns the value of the tuple’s fourth field. We then set the <code class="docutils literal notranslate"><span class="pre">key</span></code> parameter to the name of this function, and since we want the individuals with the biggest batting average first, we also set <code class="docutils literal notranslate"><span class="pre">reverse</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">53</span><span class="c1">### chap12/sorting.py</span>
<span class="linenos">54</span>
<span class="linenos">55</span><span class="k">def</span> <span class="nf">batting_avg</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
<span class="linenos">56</span>    <span class="k">return</span> <span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="linenos">57</span>
<span class="linenos">58</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;`sorted` using an attribute&#39;</span><span class="p">)</span>
<span class="linenos">59</span><span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">cs32_staff</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">batting_avg</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<p>Sorting problem solved!</p>
<div class="admonition-you-try-it admonition">
<p class="admonition-title">You Try It</p>
<p>Your <code class="docutils literal notranslate"><span class="pre">key</span></code> function doesn’t just have to use the value of one record’s attribute; it can combine the values of several attributes or pieces of these attributes. Can you figure out the function you’d write to sort a list of names by last name and break ties by first name? Try your solution on this list of names: <code class="docutils literal notranslate"><span class="pre">['Ada</span> <span class="pre">Lovelace',</span> <span class="pre">'Grace</span> <span class="pre">Hopper',</span> <span class="pre">'danah</span> <span class="pre">boyd',</span> <span class="pre">'Moses</span> <span class="pre">Liskov',</span> <span class="pre">'Barbara</span> <span class="pre">Liskov',</span> <span class="pre">'Anita</span> <span class="pre">Borg']</span></code>. Be careful with capitalization! You can find an answer in <code class="docutils literal notranslate"><span class="pre">chap12/sorting_names.py</span></code>.</p>
</div>
</section>
<section id="sorting-playing-cards">
<p><strong>Sorting playing cards.</strong> Let’s return to our initial specification and look at two different algorithms for sorting. We’ll begin with the brute-force method many use to sort the hand dealt to us when playing a card game (assuming that the game allows and benefits from having a sorted hand). Here’s an algorithmic description (i.e., pseudocode) of this method:</p>
<ol class="arabic simple">
<li><p>You pick up the unsorted stack of cards and fan them out in your hand. Let’s assume you want the smallest numbered cards on the left and the face cards and aces on the right.</p></li>
<li><p>You begin by looking at the two leftmost cards and ask yourself: “Are these two cards in the right order?” If not, you swap them.</p></li>
<li><p>With these two cards in sorted order, you now look at the 3rd card in your hand, and you ask yourself: “Where does this card belong in the sorted list of first two cards?” If it needs to go somewhere other than where it is (i.e., last in the sorted sequence), you pull it out and insert it where it belongs.</p></li>
<li><p>With these three cards in sorted order, you now look at the 4th card in your hand, and you ask yourself: “Where does it belong in the sorted list?” And so forth.</p></li>
</ol>
<p>Do you see the pattern? Computer scientists call this algorithm <em>an insertion sort</em>, and we can code it by recognizing that it involves a pair of nested for-loops. The outer loop visits each card in the unsorted part of our hand; it corresponds to the numbered steps in the pseudocode above. We need an inner loop to implement the act of insertion in each numbered step because it’s not easy to insert an element where it belongs in a sorted list. To do this, our code will walk down the sorted part of the list swapping the unsorted item with the sorted item before it until it reaches the position where it belongs in the sorted order.</p>
<div class="admonition-you-try-it admonition">
<p class="admonition-title">You Try It</p>
<p>This description might be hard to follow. Take a look at <code class="docutils literal notranslate"><span class="pre">insertion_sort</span></code> in the code block below, and then run it with the two print-statements uncommented using either the subsequent code block or <code class="docutils literal notranslate"><span class="pre">insertion_sort.py</span></code> from this book’s code repository. If you study what the routine prints for each iteration of the for-loops, you’ll better understand its swapping mechanism.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 2</span><span class="c1">### chap12/insertion_sort.py</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="k">def</span> <span class="nf">insertion_sort</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sorts the unsorted sequence s in place&quot;&quot;&quot;</span>
<span class="linenos"> 6</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
<span class="linenos"> 7</span>        <span class="c1"># print(f&#39;Considering item at index {i}&#39;)</span>
<span class="linenos"> 8</span>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="linenos"> 9</span>            <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
<span class="linenos">10</span>                <span class="c1"># Swap the two items</span>
<span class="linenos">11</span>                <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">12</span>                <span class="c1"># print(f&#39;Swapped {j-1},{j}: {s}&#39;)</span>
<span class="linenos">13</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos">14</span>                <span class="c1"># When swaps are done, the ith element is where it belongs</span>
<span class="linenos">15</span>                <span class="k">break</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">16</span><span class="c1">### chap12/insertion_sort.py</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">unsort</span><span class="p">()</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sorting list A: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="linenos">21</span><span class="n">insertion_sort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="linenos">22</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sorting list C: </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="linenos">23</span><span class="n">insertion_sort</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="linenos">24</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sorting list W: </span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="linenos">25</span><span class="n">insertion_sort</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sorted lists:&#39;</span><span class="p">)</span>
<span class="linenos">28</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="se">\n</span><span class="s1">C = </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="se">\n</span><span class="s1">W = </span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="time-complexity-of-brute-force-sorting">
<p><strong>Time complexity of brute-force sorting.</strong> Given that <code class="docutils literal notranslate"><span class="pre">insertion_sort</span></code> contains two nested for-loops that iterate at most <span class="math notranslate nohighlight">\(n\)</span>-times, where <span class="math notranslate nohighlight">\(n\)</span> is the length of the input list, we can surmise that the computational complexity of this approach is <span class="math notranslate nohighlight">\(O(n^2)\)</span>. And if you think about the worst case number of swaps that will occur during an insertion sort, you’ll calculate it to be <span class="math notranslate nohighlight">\((n * (n - 1))/2\)</span>.</p>
<div class="admonition-you-try-it admonition">
<p class="admonition-title">You Try It</p>
<p>Can you create an input list <code class="docutils literal notranslate"><span class="pre">b</span></code> of length 5 containing nothing but integers that exhibits this number of swaps (i.e., <span class="math notranslate nohighlight">\((5 * 4)/2 = 10\)</span> swaps)? Leave the print statements uncommented in <code class="docutils literal notranslate"><span class="pre">insertion_sort</span></code> so that you can count the number of swaps performed.</p>
</div>
<aside class="margin sidebar">
<p class="sidebar-title">Other Sorting Algorithms</p>
<p>A simple internet search for “sorting algorithms” will list many of the most popular sorting techniques.</p>
</aside>
<p>I called insertion sort a brute-force approach, and if the computational complexity of this approach is <span class="math notranslate nohighlight">\(O(n^2)\)</span>, then there must be a sorting algorithm that does better than this. In fact, there are several, but we’ll look at just one. This one works by thoughtfully splitting the problem into two smaller problems.</p>
</section>
<section id="binary-search">
<p><strong>Binary search.</strong> To see why this might help, let’s begin with an example of how splitting things can speed up searching. Recall the guess-the-number script from Chapter 5, and think about the strategy you employ when you try to minimize the number of guesses. Does this strategy have you guess the numbers in increasing order from the smallest possible number?</p>
<p>Of course not. That approach doesn’t use to your advantage the hints given by the computer after each guess. In particular, guessing first the number 1 in the range 1 to 100 means that the computer will respond with “Too small!” when 1 isn’t the hidden number. You could then guess 2, and unless you’re very lucky, the computer’s answer is the same. Continue in this fashion and you never take advantage of the other possible response: “Too big!”</p>
<p>Now consider what happens when your guess leaves unguessed numbers above and below it. Again assuming that whatever number you guessed wasn’t the secret, the computer’s answer of “Too small!” or “Too big!” eliminates more than just the guessed number; it eliminates the unguessed numbers either above or below your guess. If you make wise choices, your guesses can eliminate large portions of the search space and quickly get you to the secret number.</p>
<aside class="margin sidebar">
<p class="sidebar-title">Searching an Old-fashioned Phonebook</p>
<p>As another example of binary search in action, <a class="reference external" href="https://www.youtube.com/watch?v=DSffdCT5Cx4">watch Professor David Malan of CS50 fame</a> use binary search to find this book’s author in an old-fashioned phone book.</p>
</aside>
<p>The optimal strategy is called <em>a binary search</em>, in which you guess a number at the mid-point of the search space. It’s optimal because an answer of “Too small!” or “Too big!” then eliminates one half of the remaining search space, which is the best you can do on average.</p>
<p><em>A binary-search algorithm</em> has you continue in this manner (i.e., choosing the mid-point of the remaining search space each time) until you hit the hidden number. In the worst case, it takes at most <span class="math notranslate nohighlight">\(log_2 n\)</span> guesses to find the hidden number, where <span class="math notranslate nohighlight">\(n\)</span> is the size of the search space.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">guesses</span></code> function in the next code block implements the binary-search algorithm so that the computer can guess a secret number you pick, which reverses the participants’ roles in the guess-the-number game we built in Chapter 5. There’s no new Python syntax or operators in this code, but take a few moments to read through it and make sure you understand how it implements binary search.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">### chap12/guesses.py</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1"># Global constants for guessing range</span>
<span class="linenos"> 4</span><span class="n">LO</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos"> 5</span><span class="n">HI</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="k">def</span> <span class="nf">guesses</span><span class="p">():</span>
<span class="linenos"> 8</span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Welcome to I&#39;LL GUESS YOUR NUMBER ##&quot;</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Please think of a number between </span><span class="si">{</span><span class="n">LO</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">HI</span><span class="si">}</span><span class="s2">, but don&#39;t tell me.&quot;</span><span class="p">)</span>
<span class="linenos">11</span>    <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Hit return when you&#39;re ready ...&quot;</span><span class="p">)</span>
<span class="linenos">12</span>
<span class="linenos">13</span>    <span class="c1"># Possible user answers</span>
<span class="linenos">14</span>    <span class="n">answers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;too low&#39;</span><span class="p">,</span> <span class="s1">&#39;too high&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">]</span>
<span class="linenos">15</span>
<span class="linenos">16</span>    <span class="c1"># Initializations</span>
<span class="linenos">17</span>    <span class="n">lo</span> <span class="o">=</span> <span class="n">LO</span>
<span class="linenos">18</span>    <span class="n">hi</span> <span class="o">=</span> <span class="n">HI</span>
<span class="linenos">19</span>
<span class="linenos">20</span>    <span class="c1"># Use binary search as the algorithm we play by</span>
<span class="linenos">21</span>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="linenos">22</span>        <span class="c1"># Generate new guess at mid-point</span>
<span class="linenos">23</span>        <span class="n">mid</span> <span class="o">=</span> <span class="n">lo</span> <span class="o">+</span> <span class="p">(</span><span class="n">hi</span> <span class="o">-</span> <span class="n">lo</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<span class="linenos">24</span>
<span class="linenos">25</span>        <span class="c1"># Grab answer from the player</span>
<span class="linenos">26</span>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="linenos">27</span>            <span class="n">ans</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Is it </span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s1">? &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="linenos">28</span>            <span class="k">if</span> <span class="n">ans</span> <span class="ow">in</span> <span class="n">answers</span><span class="p">:</span>
<span class="linenos">29</span>                <span class="k">break</span>
<span class="linenos">30</span>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Please answer &quot;too low&quot;, &quot;too high&quot;, or &quot;yes&quot;.&#39;</span><span class="p">)</span>
<span class="linenos">31</span>
<span class="linenos">32</span>        <span class="c1"># Update range of possible guesses</span>
<span class="linenos">33</span>        <span class="k">if</span> <span class="n">ans</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
<span class="linenos">34</span>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\U0001f60e</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="linenos">35</span>            <span class="k">return</span>
<span class="linenos">36</span>        <span class="k">if</span> <span class="n">ans</span> <span class="o">==</span> <span class="s1">&#39;too low&#39;</span><span class="p">:</span>
<span class="linenos">37</span>            <span class="n">lo</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
<span class="linenos">38</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">39</span>            <span class="n">hi</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="admonition-you-try-it admonition">
<p class="admonition-title">You Try It</p>
<p>Run <code class="docutils literal notranslate"><span class="pre">guess.py</span></code> from the <code class="docutils literal notranslate"><span class="pre">chap12</span></code> code repository, which implements <code class="docutils literal notranslate"><span class="pre">guess32.py</span></code> from Chapter 5 with the same LO-HI range as <code class="docutils literal notranslate"><span class="pre">guesses.py</span></code>. Using the same secret number that the computer chose, then run <code class="docutils literal notranslate"><span class="pre">guesses.py</span></code> and see if the computer guesses this secret number in fewer turns. Next, progressively increase <code class="docutils literal notranslate"><span class="pre">HI</span></code> by a factor of 10 and watch how slowly the number of guesses taken by the computer grows. That’s the power of <span class="math notranslate nohighlight">\(log_2 n\)</span> growth.</p>
</div>
</section>
<section id="divide-and-conquer">
<p><strong>Divide and conquer.</strong> This idea of splitting a problem in half to make it easier is at the heart of this chapter’s new problem-solving technique, called <em>divide-and-conquer</em>. And just as we did in a binary-search algorithm, we’ll repeatedly split each smaller problem until we get to a situation where we know the answer.</p>
<p>In the context of sorting, we start with an unsorted list and split it in half. This split produces two lists, which most likely are themselves unsorted, but let’s pause and consider what we’d do if the split happens to produce two sorted lists.</p>
<p>To be clear, splits don’t sort. But we might be lucky and start with an unsorted list like <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">3,</span> <span class="pre">5,</span> <span class="pre">2,</span> <span class="pre">4,</span> <span class="pre">6]</span></code>. If we split this list between the <code class="docutils literal notranslate"><span class="pre">5</span></code> and the <code class="docutils literal notranslate"><span class="pre">2</span></code>, we’re left with two sorted lists. It seems useless to split each of these sorted lists into twice as many sorted lists. What we should do when we want to combine two sorted lists into one?</p>
<p>We need a function that quickly <em>merges</em> two sorted lists into a single sorted list. Such a script is not hard to build if we recognize that the first item in the single sorted list must be one of the first two items in the smaller sorted lists. We’ll pop that item from its sorted list and append it to our single, output list. One of the sorted lists is now one element shorter, but we’re back to the question we just asked: which of the two items at the front of the two sorted lists should be appended to the single sorted list?</p>
<p>That’s the core of the merge function that combines all the lists we produced by splitting. We’ll switch from splitting to merging when we’ve done enough splitting to produce nothing but sorted lists.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In general, every divide-and-conquer algorithm has some sort of splitting phase and a complementary merging phase.</p>
</div>
<p>The next code block lists an implementation of <code class="docutils literal notranslate"><span class="pre">merge</span></code> for a divide-and-conquer sorting algorithm. This function takes two sorted lists as input and returns a single sorted list containing all the elements of both input lists. The code is more complex than what I described earlier because it handles the corner cases I glossed over. For example, what do you do if one of the input lists is empty? Lines 6-10 check for this condition and have <code class="docutils literal notranslate"><span class="pre">merge</span></code> return the other list. Similarly, what do you do in the loop starting on line 18 when you’ve popped all the items off one list and the other isn’t empty? Lines 19-22 check for this condition and have <code class="docutils literal notranslate"><span class="pre">merge</span></code> append whatever is at the head of the non-empty list.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">### chap12/merge.py</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given two sorted lists, return a single sorted list&quot;&quot;&quot;</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>    <span class="c1"># Check for and handle trivial merge cases</span>
<span class="linenos"> 7</span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 8</span>        <span class="k">return</span> <span class="n">b</span>
<span class="linenos"> 9</span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">10</span>        <span class="k">return</span> <span class="n">a</span>
<span class="linenos">11</span>
<span class="linenos">12</span>    <span class="c1"># Create a place to put the merged lists</span>
<span class="linenos">13</span>    <span class="n">merged</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">14</span>    <span class="c1"># Calculate how long the merged list should be</span>
<span class="linenos">15</span>    <span class="n">tot_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="linenos">16</span>
<span class="linenos">17</span>    <span class="c1"># Merge a and b</span>
<span class="linenos">18</span>    <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">merged</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tot_length</span><span class="p">):</span>
<span class="linenos">19</span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">20</span>            <span class="n">merged</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="linenos">21</span>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">22</span>            <span class="n">merged</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="linenos">23</span>        <span class="k">elif</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<span class="linenos">24</span>            <span class="n">merged</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="linenos">25</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">26</span>            <span class="n">merged</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="linenos">27</span>
<span class="linenos">28</span>    <span class="k">return</span> <span class="n">merged</span>
</pre></div>
</div>
</section>
<section id="from-split-to-merge">
<p><strong>From split to merge.</strong> Knowing how to split and how to merge, we have the pieces we need for a divide-and-conquer sort, but how do we know when to transition from the initial split phase to the final merge phase? Well, we know the conditions that need to be true to use <code class="docutils literal notranslate"><span class="pre">merge</span></code>: it can begin once we have nothing but sorted lists. This means that the question we really want to answer is, “Without checking the order of its elements, how small a list must split produce before we know that the list is sorted?” If we answer this question, then we know when we’ll can stop splitting and start merging.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We’re not relying on luck, as we did in the earlier example, and we can’t take the time to check the order of the elements in a list. We want to know when we can look at a simple attribute of a list, like its length, and know that it must be sorted. To answer a question that asks for a guarantee, we often focus on the edge conditions in a problem. This type of thinking is one way people searchCod for new algorithms.</p>
</div>
<p>Did you figure it out? Empty lists and lists with a single element are guaranteed to be sorted. Nicely, our <code class="docutils literal notranslate"><span class="pre">merge</span></code> function properly handles lists of these lengths.</p>
<p>We now understand the full divide-and-conquer method of sorting, which computer scientists call <em>merge sort</em>. The algorithm is easy to describe:</p>
<ol class="arabic simple">
<li><p>Repeatedly split unsorted lists in half. It’s fine if one “half” is one element larger than the other.</p></li>
<li><p>When split has reached the point where all lists are of length 0 or 1, stop splitting and begin merging.</p></li>
<li><p>Repeatedly merge pairs of sorted lists until only one list remains.</p></li>
</ol>
</section>
<section id="iterative-merge-sort">
<p><strong>Iterative merge sort.</strong> All that’s left for us to do is translate this pseudocode into Python, which we’ll do twice. The code block below implements the merge-sort algorithm using while-loops, which computer scientists call an iterative approach. It’s not pretty, and it fakes the splitting part. By this, I mean that we know we’re going to split the original list all the way down until we have lists of length 0 or 1, and so the code just goes there. Line 15 implements all that work in one simple assignment. The function then iteratively merges adjacent pairs of sublists. Inside the innermost while-loop, it calls our earlier function <code class="docutils literal notranslate"><span class="pre">merge</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 3</span><span class="c1">### chap12/imerge_sort.py</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="k">def</span> <span class="nf">merge_sort</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterative merge sort: s sorted in place&quot;&quot;&quot;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>    <span class="c1"># Catch trivial cases (i.e., lists that are guaranteed to be sorted)</span>
<span class="linenos"> 9</span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
<span class="linenos">10</span>        <span class="k">return</span>
<span class="linenos">11</span>    
<span class="linenos">12</span>    <span class="c1"># Imagine a splitting process all the way down</span>
<span class="linenos">13</span>    <span class="c1"># to sublists of length 1, which will then</span>
<span class="linenos">14</span>    <span class="c1"># grow back up to len(s) in powers of 2</span>
<span class="linenos">15</span>    <span class="n">sublist_len</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos">16</span>
<span class="linenos">17</span>    <span class="c1"># Merge all sorted sublists back up the tree of splits</span>
<span class="linenos">18</span>    <span class="k">while</span> <span class="n">sublist_len</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="linenos">19</span>        <span class="c1"># i is the starting index of the next two sublists to merge</span>
<span class="linenos">20</span>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">21</span>
<span class="linenos">22</span>        <span class="c1"># Merge all pairs of sorted sublists of length sublist_len</span>
<span class="linenos">23</span>        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="linenos">24</span>            <span class="c1"># Compute the end index of the first sublist</span>
<span class="linenos">25</span>            <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">sublist_len</span>
<span class="linenos">26</span>            <span class="c1"># Catch the special case of the last sublist&#39;s length</span>
<span class="linenos">27</span>            <span class="c1"># that may be shorter than sublist_len</span>
<span class="linenos">28</span>            <span class="n">k</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">sublist_len</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="linenos">29</span>
<span class="linenos">30</span>            <span class="n">merged</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">k</span><span class="p">])</span>
<span class="linenos">31</span>
<span class="linenos">32</span>            <span class="c1"># Put the merged list back into s</span>
<span class="linenos">33</span>            <span class="n">ii</span> <span class="o">=</span> <span class="n">i</span>
<span class="linenos">34</span>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">merged</span><span class="p">:</span>
<span class="linenos">35</span>                <span class="n">s</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>
<span class="linenos">36</span>                <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="linenos">37</span>
<span class="linenos">38</span>            <span class="c1"># Move to the next pair of sublists to merge</span>
<span class="linenos">39</span>            <span class="n">i</span> <span class="o">+=</span> <span class="n">sublist_len</span> <span class="o">*</span> <span class="mi">2</span>
<span class="linenos">40</span>
<span class="linenos">41</span>        <span class="c1"># Increase the length of the sublists to merge</span>
<span class="linenos">42</span>        <span class="n">sublist_len</span> <span class="o">*=</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="admonition-you-try-it admonition">
<p class="admonition-title">You Try It</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">merge_sort</span></code> implements the merge-sort algorithm using the hammer of iteration. It works, but as we’ll soon see, it is not the best tool for the job. Nonetheless, the next code block exercises this implementation, and I encourage you run it as you read through the code. While these blocks don’t contain any new Python syntax, this iterative implementation does a lot of hard-to-follow slicing in a pair of nested while-loops. You might drop in a few print-statements to make it easier for you to understand its work.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">43</span><span class="c1">### chap12/imerge_sort.py</span>
<span class="linenos">44</span>
<span class="linenos">45</span><span class="c1"># Test merge_sort using our unsorted lists</span>
<span class="linenos">46</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">unsort</span><span class="p">()</span>
<span class="linenos">47</span><span class="n">merge_sort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="linenos">48</span><span class="n">merge_sort</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="linenos">49</span><span class="n">merge_sort</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="linenos">50</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;a = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="se">\n</span><span class="s1">c = </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="se">\n</span><span class="s1">w = </span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="recursion">
<p><strong>Recursion.</strong> Despite the ugliness of this implementation, merge sort is typically faster than insertion sort. Given a list of <span class="math notranslate nohighlight">\(n\)</span> elements, insertion sort has a worst-case computational complexity of <span class="math notranslate nohighlight">\(O(n^2)\)</span> and merge sort of <span class="math notranslate nohighlight">\(O(n log_2 n)\)</span>. This is because merge sort makes <span class="math notranslate nohighlight">\(O(log_2 n)\)</span> splits and this same number of merges, and each merge step requires <span class="math notranslate nohighlight">\(O(n)\)</span> work. On sorting a large list, this complexity difference is significant.</p>
<p>But it’s beginning to appear that to run faster, we must pay for this speed boost with a more complex implementation. Just eyeball <code class="docutils literal notranslate"><span class="pre">insertion_sort</span></code> versus <code class="docutils literal notranslate"><span class="pre">merge_sort</span></code>, and recall what we saw in comparing <code class="docutils literal notranslate"><span class="pre">bf_strmatch</span></code> against <code class="docutils literal notranslate"><span class="pre">rk_strmatch</span></code>. Despite these two examples, we’ll see it’s not always true that increased speed begets an ugly implementation. Sometimes we just need to use the right tool, and for divide-and-conquer algorithms, that tool is <em>recursion</em>.</p>
<p>Recursion is a fancy way of saying that a function repeatedly calls itself. While having a function call itself in this manner may sound like a recipe for an infinite loop, we avoid this outcome by:</p>
<aside class="margin sidebar">
<p class="sidebar-title">Nesting Dolls</p>
<p>It might help to have an image of the <a class="reference external" href="https://en.wikipedia.org/wiki/Matryoshka_doll">Russian Matryoshka Dolls</a> in your mind. Each inner doll is smaller than its outer doll, and if you open them all, you’ll find that the innermost doll doesn’t open. That innermost doll is the base case.</p>
</aside>
<ol class="arabic simple">
<li><p>Requiring each recursive call to solve a slightly smaller (or simpler) problem, and;</p></li>
<li><p>Making sure we have what are called one or more base cases, which do not involve a recursive call.</p></li>
</ol>
<p>Before we look at the recursive form of merge sort, let’s get a feel for the structure of a recursive implementation by looking at the canonical recursive algorithm: factorial. You probably remember that the factorial of a number <span class="math notranslate nohighlight">\(n\)</span>, expressed in mathematical notation as <span class="math notranslate nohighlight">\(n!\)</span>, is the product of the numbers between <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(1\)</span>, inclusive.</p>
<p>We can directly calculate the factorial of a number like 4 by computing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">factorial_of_4</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">1</span>
</pre></div>
</div>
<p>But we can also express it as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">factorial_of_3</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">1</span>
<span class="n">factorial_of_4</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">factorial_of_3</span>
</pre></div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title">Details</p>
<p>Factorial is defined only for non-negative integers.</p>
</aside>
<p>Using this idea, let’s assume we have a function <code class="docutils literal notranslate"><span class="pre">factorial</span></code> that takes a single input parameter <code class="docutils literal notranslate"><span class="pre">n</span></code> and returns its factorial value, then the following equality would be true for any positive integer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This is a divide-and-conquer approach, albeit unbalanced in its split. Nonetheless, it nicely illustrates recursion. We are basically saying, “If I knew the factorial of <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">-</span> <span class="pre">1</span></code>, I could compute the factorial of <code class="docutils literal notranslate"><span class="pre">n</span></code> with one multiplication.” In general, we don’t and so we call the function <code class="docutils literal notranslate"><span class="pre">factorial</span></code> from within itself (recursion!) to determine what the answer to this slightly smaller problem is.</p>
<p>From this, we can begin writing the implementation of the <code class="docutils literal notranslate"><span class="pre">factorial</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This function matches our earlier description, but what happens when we call <code class="docutils literal notranslate"><span class="pre">factorial(4)</span></code>?</p>
<div class="admonition-you-try-it admonition">
<p class="admonition-title">You Try It</p>
<p>While you can write yourself a short script containing the previous code block and a call of <code class="docutils literal notranslate"><span class="pre">factorial(4)</span></code>, it is more informative to watch each step of the function’s execution using <a class="reference external" href="https://pythontutor.com/visualize.html#code=def%20factorial%28n%29%3A%0A%20%20%20%20return%20n%20*%20factorial%28n%20-%201%29%0A%20%20%20%20%0Afactorial%284%29&amp;cumulative=false&amp;heapPrimitives=nevernest&amp;mode=edit&amp;origin=opt-frontend.js&amp;py=3&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false">the Python Tutor</a>.</p>
</div>
<p>What’s missing, of course, are the base cases. To add the base cases to our function, we need to know for what values of <code class="docutils literal notranslate"><span class="pre">n</span></code> do we know <code class="docutils literal notranslate"><span class="pre">factorial(n)</span></code> without having to compute it. Or equivalently, for what values of <span class="math notranslate nohighlight">\(n\)</span> is it trivial to compute <span class="math notranslate nohighlight">\(n!\)</span>?</p>
<p>Right! By definition of the mathematical function, we know that <span class="math notranslate nohighlight">\(1!\)</span> and <span class="math notranslate nohighlight">\(0!\)</span> are both <span class="math notranslate nohighlight">\(1\)</span>. If we checked the input parameter <code class="docutils literal notranslate"><span class="pre">n</span></code> to see if was <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>, we could skip the recursive call and just return the known answer. The following is a complete and correct recursive implementation of factorial. You can check this implementation with a few unit tests in the subsequent code block.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">### chap12/factorial.py</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="k">def</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="linenos">4</span>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="linenos">5</span>        <span class="k">return</span> <span class="mi">1</span>
<span class="linenos">6</span>    <span class="k">elif</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">7</span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;factorial is defined only for positive n&#39;</span><span class="p">)</span>
<span class="linenos">8</span>    <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 9</span><span class="c1">### chap12/factorial.py</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="c1"># Test code</span>
<span class="linenos">12</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing factorial ...&#39;</span><span class="p">)</span>
<span class="linenos">13</span><span class="k">assert</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Failed for n = 0&#39;</span>
<span class="linenos">14</span><span class="k">assert</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Failed for n = 1&#39;</span>
<span class="linenos">15</span><span class="k">assert</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Failed for n = 2&#39;</span>
<span class="linenos">16</span><span class="k">assert</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;Failed for n = 3&#39;</span>
<span class="linenos">17</span><span class="k">assert</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;Failed for n = 4&#39;</span>
<span class="linenos">18</span><span class="k">assert</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">==</span> <span class="mi">20922789888000</span><span class="p">,</span> <span class="s1">&#39;Failed for n = 16&#39;</span>
<span class="linenos">19</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PASSED our unit tests!&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Congratulations! You just wrote your first recursive program.</p>
</section>
<section id="iterative-factorial">
<p><strong>Iterative factorial.</strong> I mentioned that factorial was the canonical example of a calculation that can be solved by divide and conquer and implemented in a recursive style, but you might wonder what this function looks like if written using an explicit looping statement.</p>
<div class="admonition-you-try-it admonition">
<p class="admonition-title">You Try It</p>
<p>Try writing the function <code class="docutils literal notranslate"><span class="pre">factorial</span></code> using either a for- or while-loop. You can find my for-loop solution in <code class="docutils literal notranslate"><span class="pre">ffactorial.py</span></code> and my while-loop solution in <code class="docutils literal notranslate"><span class="pre">wfactorial.py</span></code>.</p>
</div>
<aside class="margin sidebar">
<p class="sidebar-title">While vs. For</p>
<p>By the way, as expected, when compared to the for-loop solution, the while-loop solution requires us to manage the loop’s index variable. I reuse the input parameter as the while-loop’s index variable to save one initialization. Nothing new here.</p>
</aside>
<p>Notice that both of these iterative solutions require us to create a named temporary, which I called <code class="docutils literal notranslate"><span class="pre">result</span></code> in my solutions. This temporary exists in the recursive version of the code as the returned result from each recursive call. You can see this by watching the execution of <a class="reference external" href="https://pythontutor.com/visualize.html#code=def%20factorial(n):%0A%20%20%20%20if%20n%20%3C%200:%0A%20%20%20%20%20%20%20%20raise%20ValueError(%22factorial%20is%20not%20defined%20for%20negative%20integers%22)%0A%20%20%20%20elif%20n%20%3C%202:%0A%20%20%20%20%20%20%20%20return%201%0A%20%20%20%20else:%0A%20%20%20%20%20%20%20%20return%20n%20*%20factorial(n%20-%201)%0A%20%20%20%20%0Afactorial(4)&amp;cumulative=false&amp;curInstr=0&amp;heapPrimitives=nevernest&amp;mode=display&amp;origin=opt-frontend.js&amp;py=3&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false">our complete recursive factorial function on Python Tutor</a>.</p>
</section>
<section id="recursive-merge-sort">
<p><strong>Recursive merge sort.</strong> You might prefer the simplicity of the code in <code class="docutils literal notranslate"><span class="pre">factorial</span></code> over the other two implementations. And if you are inclined to think mathematically, this implementation clearly reflects the mathematical formulation of the problem, which might make this code easier for you to read and understand.</p>
<p>This simplicity of expression is a characteristic of recursive code, and it is why there are quite a few people who speak with a religious fervor about recursion. But it is true that this simplicity-of-expression quality becomes more evident as the divide-and-conquer problems we’re trying to solve become more complex. Let’s keep this in mind as we look at the recursive solution to merge sort.</p>
<aside class="margin sidebar">
<p class="sidebar-title">Minor Interface Change</p>
<p>The recursive solution will use the same <code class="docutils literal notranslate"><span class="pre">merge</span></code> function that we used in the iterative solution, but I will slightly change its interface. While the iterative solution sorted the input list in place, it is more natural for the recursive solution to return the sorted list. This has to do with the lack of an explicit temporary, which we noticed in looking at the several factorial implementations.</p>
</aside>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 3</span><span class="c1">### chap12/merge_sort.py</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="k">def</span> <span class="nf">merge_sort</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursive merge sort: returns a sorted list&quot;&quot;&quot;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>    <span class="c1"># Catch trivial cases (i.e., lists that are sorted by definition)</span>
<span class="linenos"> 9</span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
<span class="linenos">10</span>        <span class="k">return</span> <span class="n">s</span>
<span class="linenos">11</span>
<span class="linenos">12</span>    <span class="c1"># Find index at truncated midpoint of list</span>
<span class="linenos">13</span>    <span class="n">mid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<span class="linenos">14</span>
<span class="linenos">15</span>    <span class="c1"># Return merge of the two sorted halves</span>
<span class="linenos">16</span>    <span class="k">return</span> <span class="n">merge</span><span class="p">(</span><span class="n">merge_sort</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">mid</span><span class="p">]),</span> <span class="n">merge_sort</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">mid</span><span class="p">:]))</span>
</pre></div>
</div>
<p>Are you thinking, “That’s it? Where’s the rest of the code?” There is no more code. That’s all it takes to write merge sort recursively.</p>
<p>Not sure? Let’s test it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">17</span><span class="c1">### chap12/merge_sort.py</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="c1"># Test merge_sort using our unsorted lists</span>
<span class="linenos">20</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">unsort</span><span class="p">()</span>
<span class="linenos">21</span><span class="n">aa</span> <span class="o">=</span> <span class="n">merge_sort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="linenos">22</span><span class="n">cc</span> <span class="o">=</span> <span class="n">merge_sort</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="linenos">23</span><span class="n">ww</span> <span class="o">=</span> <span class="n">merge_sort</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="linenos">24</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;a = </span><span class="si">{</span><span class="n">aa</span><span class="si">}</span><span class="se">\n</span><span class="s1">c = </span><span class="si">{</span><span class="n">cc</span><span class="si">}</span><span class="se">\n</span><span class="s1">w = </span><span class="si">{</span><span class="n">ww</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title">More Practice with Recursion</p>
<p>In this chapter’s active-learning exercises, you’ll explore a fun recursive problem from nature, which will also introduce you to plotting in Python.</p>
</aside>
<p>What do you think now about recursion as a way of expressing a problem’s implementation? As you can see, it works extremely well for problems that are amenable to divide-and-conquer solutions. Interestingly, a large number of problems in math and nature are neatly expressed in recursive formulations because we can solve them with <em>induction</em>, which is what we saw in our recursive solution to factorial.</p>
</section>
<section id="beckett-s-challenge">
<p><strong>Beckett’s challenge.</strong> As promised, this chapter ends by solving a problem that doesn’t seem like it is amenable to a divide-and-conquer approach. Now, I don’t expect you to see the solution before it’s presented. I don’t even expect you to feel comfortable with the solution after you’ve played with its recursive implementation. It takes time and repeated practice to think in this way, and you’re probably still striving to be comfortable building iterative solutions. I simply ask you to work through this final problem and appreciate the power of the approach and the simplicity of the solution. And then remember this technique when you’re solving your own problems.</p>
<aside class="margin sidebar">
<p class="sidebar-title">Credit</p>
<p>I learned about this challenge from Robert Sedgewick and Kevin Wayne’s book, <em>Computer Science: An Interdisciplinary Approach</em> (2017). It appears as Program 2.3.3.</p>
</aside>
<p>Since this book has a theatrical theme, we’re going to investigate a problem posed by <a class="reference external" href="https://en.wikipedia.org/wiki/Samuel_Beckett">the playwright Samuel Beckett</a>. One of his plays, named <em>Quad</em>, has the actors to enter and exit the stage so that <em>the same subset of actors never appear together more than once</em>.</p>
<p>What does this mean? Let’s imagine a play with three actors, named <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>, and <code class="docutils literal notranslate"><span class="pre">C</span></code>. As the play begins, the curtain rises on an empty stage. We’ll represent an empty stage by placing a <code class="docutils literal notranslate"><span class="pre">0</span></code> under each of the actors’ names. Then, when actor enters the stage, we’ll change their <code class="docutils literal notranslate"><span class="pre">0</span></code> to a <code class="docutils literal notranslate"><span class="pre">1</span></code>. When they exit, their <code class="docutils literal notranslate"><span class="pre">1</span></code> becomes a <code class="docutils literal notranslate"><span class="pre">0</span></code>. Only one actor will enter or exit the stage at any instance in time.</p>
<p>Under these constraints and with these encodings, <a class="reference internal" href="#c12-table1-ref"><span class="std std-numref">Figure 24</span></a> illustrates a solution to Beckett’s challenge for our three actors <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>, and <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p>
<figure class="align-default" id="c12-table1-ref">
<img alt="_images/c12_table1.png" src="_images/c12_table1.png" />
<figcaption>
<p><span class="caption-number">Fig. 24 </span><span class="caption-text">A solution to Beckett’s challenge with three actors.</span><a class="headerlink" href="#c12-table1-ref" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>This table contains eight rows (not counting the header) because the number of different subsets of <span class="math notranslate nohighlight">\(n\)</span> objects is exactly <span class="math notranslate nohighlight">\(2^n\)</span>. To verify that this table, when reading the rows in order from top to bottom, is a solution to Beckett’s challenge, notice that, when looking at the <code class="docutils literal notranslate"><span class="pre">ABC</span></code> encoding in binary, no two rows of the table are the same, which means that no subset of actors is on the stage more than once.</p>
</section>
<section id="its-base-case">
<p><strong>Its base case.</strong> To create a script that can solve Beckett’s challenge for any number of actors, we must first choose a divide-and-conquer approach. You’ve seen two different divide-and-conquer examples, and let’s try the approach we took in factorial. Recall that it wrote an expression for the factorial of a number using the factorial of the number that was one less. Perhaps we can solve Beckett’s challenge with <code class="docutils literal notranslate"><span class="pre">n</span></code> actors by assuming we know the solution to the challenge with <code class="docutils literal notranslate"><span class="pre">n-1</span></code> actors.</p>
<p>Hmmm. It’s not immediately obvious to me what stage directions we need to add to the solution with <code class="docutils literal notranslate"><span class="pre">n-1</span></code> actors that produces the solution with <code class="docutils literal notranslate"><span class="pre">n</span></code> actors, and so let’s try some simple examples. What would we print for stage directions to solve Beckett’s challenge for a play with no actors? It is the smallest Beckett challenge, and it feels like our base case.</p>
<p>Do you see that we’d print nothing for a challenge involving zero actors? We have an empty stage, and no actors to enter or exit it. During the recursive call sequence, when we’re calling our function with ever smaller problems, this is our function’s base case. Let’s start writing our recursive <code class="docutils literal notranslate"><span class="pre">beckett</span></code> function so that it prints nothing and returns when called with no actors.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">### chap12/beckett0.py</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="k">def</span> <span class="nf">beckett</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="linenos">4</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given n actors, print stage directions&quot;&quot;&quot;</span>
<span class="linenos">5</span>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">6</span>        <span class="k">return</span>
</pre></div>
</div>
</section>
<section id="the-play-with-a-single-actor">
<p><strong>The play with a single actor.</strong> Beckett’s challenge with a single actor should print the first two lines in  <a class="reference internal" href="#c12-table1-ref"><span class="std std-numref">Figure 24</span></a>. The first line is a unique stage direction, and we want it printed even in the challenge with no actors. But we don’t want <code class="docutils literal notranslate"><span class="pre">&quot;empty</span> <span class="pre">stage&quot;</span></code> printed in the base case of the recursion; it should be printed only at the start of a challenge. This reasoning leads us to put this print-statement in the function that calls <code class="docutils literal notranslate"><span class="pre">beckett</span></code> and starts the recursion.</p>
<aside class="margin sidebar">
<p class="sidebar-title">Actor Names</p>
<p>Let’s not worry about printing the actor’s names, which is a detail we’ll fix when we have a correctly working recursive function.</p>
</aside>
<p>Inside our current <code class="docutils literal notranslate"><span class="pre">beckett</span></code> function, we have the base case, and we need to add a recursive call and the print-statement that outputs <code class="docutils literal notranslate"><span class="pre">&quot;enter</span> <span class="pre">1&quot;</span></code> for our current example. A base case, a recursive call, and some problem-specific work is what constitutes the normal structure of a recursive function. But where does the recursive call go? Before or after our print-statement? You can see for yourself that either case correctly prints what we want for challenges with 0 or 1 actors.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">### chap12/beckett1.py</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="k">def</span> <span class="nf">beckett</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given n actors, print stage directions&quot;&quot;&quot;</span>
<span class="linenos"> 5</span>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 6</span>        <span class="k">return</span>
<span class="linenos"> 7</span>    
<span class="linenos"> 8</span>    <span class="n">beckett</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>     <span class="c1"># recursive call here?</span>
<span class="linenos"> 9</span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;enter&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="linenos">10</span>    <span class="c1"># beckett(n - 1)     # or here?</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1"># Test with 1 actor</span>
<span class="linenos">13</span><span class="n">num_actors</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;empty stage&#39;</span><span class="p">)</span>
<span class="linenos">16</span><span class="n">beckett</span><span class="p">(</span><span class="n">num_actors</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="looking-for-the-pattern">
<p><strong>Looking for the pattern.</strong> To design an algorithm that generates stage directions of the form “enter X” and “exit Y” for the play in <a class="reference internal" href="#c12-table1-ref"><span class="std std-numref">Figure 24</span></a>, we must identify and understand the repeating patterns in the table’s sequence of binary encodings. In general, coding with recursion involves finding the pattern that repeats, each time on a smaller scale. Let’s focus on the solution table for the challenge with two actors.</p>
<figure class="align-default" id="c12-table2-ref">
<img alt="_images/c12_table2.png" src="_images/c12_table2.png" />
<figcaption>
<p><span class="caption-number">Fig. 25 </span><span class="caption-text">A solution to Beckett’s challenge with two actors.</span><a class="headerlink" href="#c12-table2-ref" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>In <a class="reference internal" href="#c12-table2-ref"><span class="std std-numref">Figure 25</span></a>, what do you notice about the sequencing of the bits for actor <code class="docutils literal notranslate"><span class="pre">B</span></code>? Compare the first two boxed values against the last boxed two. Yes! The sequence reverses itself.</p>
<p>Now look at actor <code class="docutils literal notranslate"><span class="pre">A</span></code>. They act like an actor in the one-actor challenge: Halfway through the play they enter and never exit. But this halfway point is far enough into the play that actor <code class="docutils literal notranslate"><span class="pre">B</span></code> has time to go through a <code class="docutils literal notranslate"><span class="pre">0-1</span></code> dance. And once <code class="docutils literal notranslate"><span class="pre">A</span></code> enters, this actor waits patiently as actor <code class="docutils literal notranslate"><span class="pre">B</span></code> reverses their dance from the first half.</p>
<p>With that pattern in mind, look back at <a class="reference internal" href="#c12-table1-ref"><span class="std std-numref">Figure 24</span></a>. Actor <code class="docutils literal notranslate"><span class="pre">A</span></code> enters halfway through the play. When they enter, they left enough time for actors <code class="docutils literal notranslate"><span class="pre">B</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code> to go through a dance, which these two actors reverse once <code class="docutils literal notranslate"><span class="pre">A</span></code> enters. And the dance that B and C do in the first four rows is the same dance they did in the 2-actor challenge!</p>
</section>
<section id="a-polished-full-solution">
<p><strong>A polished, full solution.</strong> With the pattern recognized, what remains is to convert the pattern into code. While I won’t take you through the details, I will highlight a few interesting aspects that we didn’t see in <code class="docutils literal notranslate"><span class="pre">factorial</span></code> or <code class="docutils literal notranslate"><span class="pre">merge_sort</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">beckett</span></code> needs to make two recursive calls corresponding to the dance <code class="docutils literal notranslate"><span class="pre">A</span></code> watches off stage and then the dance this actor watches while on stage. The same is true for every actor.</p></li>
<li><p>The printing goes between the two recursive calls, which means that we had the right idea in <code class="docutils literal notranslate"><span class="pre">beckett1.py</span></code>, even if we didn’t realize it at the time. You can see this by focusing on actor <code class="docutils literal notranslate"><span class="pre">A</span></code>, who we just discussed watches off-stage as the other actors go through their dance (i.e., the first recursive call). Actor <code class="docutils literal notranslate"><span class="pre">A</span></code> then enters the stage (i.e., we print <code class="docutils literal notranslate"><span class="pre">&quot;enter</span> <span class="pre">A&quot;</span></code>). And finally, this actor watches on-stage as the other actors go through their reversed dance (i.e., the second recursive call).</p></li>
<li><p>We need to send along another piece of information, which is a Boolean telling the recursion whether an actor is in the “dance-in” or “dance-out” portion of their pattern. This is the purpose of the <code class="docutils literal notranslate"><span class="pre">enters</span></code> parameter on <code class="docutils literal notranslate"><span class="pre">beckett</span></code>.</p></li>
</ul>
<aside class="margin sidebar">
<p class="sidebar-title">Gray Codes</p>
<p>What the <code class="docutils literal notranslate"><span class="pre">beckett</span></code> script produces is called a <strong>Gray code</strong>, which has found many uses in our world, from electronic devices to experimental design. Now that you know about them, feel free to read about them and look for them in your world!</p>
</aside>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">### chap12/beckett.py</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1"># Set the number of actors in your play, which</span>
<span class="linenos"> 4</span><span class="c1"># must be less than or equal to 10</span>
<span class="linenos"> 5</span><span class="n">num_actors</span> <span class="o">=</span> <span class="mi">3</span>
<span class="linenos"> 6</span><span class="k">assert</span> <span class="n">num_actors</span> <span class="o">&lt;=</span> <span class="mi">10</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1"># Setup for pretty printing</span>
<span class="linenos"> 9</span><span class="n">on_stage</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># encoding of who is on stage</span>
<span class="linenos">10</span><span class="n">names</span> <span class="o">=</span> <span class="s1">&#39;ABCDEFGHIJ&#39;</span><span class="p">[:</span><span class="n">num_actors</span><span class="p">]</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="k">def</span> <span class="nf">stage_print</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="linenos">13</span>    <span class="k">global</span> <span class="n">on_stage</span>
<span class="linenos">14</span>    <span class="k">if</span> <span class="nb">dir</span> <span class="o">==</span> <span class="s1">&#39;enter&#39;</span><span class="p">:</span>
<span class="linenos">15</span>        <span class="n">on_stage</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">16</span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos">17</span>        <span class="n">on_stage</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">18</span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">bin</span><span class="p">(</span><span class="n">on_stage</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="n">num_actors</span><span class="p">)</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="nb">dir</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">names</span><span class="p">[</span><span class="n">num_actors</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">n</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="linenos">19</span>    
<span class="linenos">20</span><span class="k">def</span> <span class="nf">beckett</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">enters</span><span class="p">):</span>
<span class="linenos">21</span>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">22</span>        <span class="c1"># No characters so no stage directions</span>
<span class="linenos">23</span>        <span class="k">return</span>
<span class="linenos">24</span>
<span class="linenos">25</span>    <span class="n">beckett</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="linenos">26</span>    <span class="k">if</span> <span class="n">enters</span><span class="p">:</span>
<span class="linenos">27</span>        <span class="n">stage_print</span><span class="p">(</span><span class="s1">&#39;enter&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="linenos">28</span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos">29</span>        <span class="n">stage_print</span><span class="p">(</span><span class="s1">&#39;exit&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="linenos">30</span>    <span class="n">beckett</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="c1"># Start printing the solution table</span>
<span class="linenos">33</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">bin</span><span class="p">(</span><span class="n">on_stage</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="n">num_actors</span><span class="p">)</span><span class="si">}</span><span class="s1"> empty stage&#39;</span><span class="p">)</span>
<span class="linenos">34</span><span class="n">beckett</span><span class="p">(</span><span class="n">num_actors</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>This final <code class="docutils literal notranslate"><span class="pre">beckett</span></code> function is disturbingly simple, and that’s what happens when the pattern embedded in the problem is matched with the right tool. In this case, the tool was a divide-and-conquer approach coupled with the technique of recursion.</p>
<p>I hope you understand how the recursive <code class="docutils literal notranslate"><span class="pre">beckett</span></code> function works. I hope you’ve also begun to realize that learning to write a recursive function from a recursive specification, like we did with factorial and merge sort, is hard but worthwhile. Designing a recursive solution to a problem like Beckett’s challenge is even harder, but you can do it if you take it a step at a time, as we just did.</p>
<p>[Version 20230930]</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="chap11.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 11: Discover Driving Directions</p>
      </div>
    </a>
    <a class="right-next"
       href="chap13.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 13: Rewrite the Error Messages</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-specification-for-sorting">A specification for sorting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-in-python">Sorting in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-in-descending-order">Sorting in descending order</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-with-your-own-comparison-function">Sorting with your own comparison function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-playing-cards">Sorting playing cards</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-complexity-of-brute-force-sorting">Time complexity of brute-force sorting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-search">Binary search</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#divide-and-conquer">Divide and conquer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#from-split-to-merge">From split to merge</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iterative-merge-sort">Iterative merge sort</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recursion">Recursion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iterative-factorial">Iterative factorial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recursive-merge-sort">Recursive merge sort</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#beckett-s-challenge">Beckett’s challenge</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#its-base-case">Its base case</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-play-with-a-single-actor">The play with a single actor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#looking-for-the-pattern">Looking for the pattern</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-polished-full-solution">A polished, full solution</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mike Smith
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023 by Michael D. Smith. All rights reserved.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>