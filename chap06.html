

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Chapter 6: Do You See My Dog? &#8212; Computational Thinking and Problem Solving</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chap06';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapter 7: Many But Not Any Number" href="chap07.html" />
    <link rel="prev" title="Chapter 5: Play Guess-a-number" href="chap05.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="ctps.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/mike_flat.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/mike_flat.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="ctps.html">
                    <no title>
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="welcome.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap01.html">Chapter 1: Read a Children’s Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap02.html">Chapter 2: Grab the Dialogue</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap03.html">Chapter 3: Replace Text with Emoji</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap04.html">Chapter 4: Query a Web Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap05.html">Chapter 5: Play Guess-a-number</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 6: Do You See My Dog?</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap07.html">Chapter 7: Many But Not Any Number</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap08.html">Chapter 8: What Is My Problem?</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap09.html">Chapter 9: Find a Phrase</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap10.html">Chapter 10: Build an Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap11.html">Chapter 11: Discover Driving Directions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap12.html">Chapter 12: Divide and Conquer</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap13.html">Chapter 13: Rewrite the Error Message</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap14.html">Chapter 14: The Dream of Bug Fixing</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap15.html">Chapter 15: Embrace Runtime Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap16.html">Chapter 16: Catch Them Early</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap17.html">Chapter 17: Build Prediction Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap18.html">Chapter 18: Use Generative AI</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chap06.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 6: Do You See My Dog?</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numbers-and-knowledge">Numbers and knowledge</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#do-you-see-my-dog">Do you see my dog?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#no-interpretation-please">No interpretation, please</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-a-hexdump">Reading a hexdump</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hexadecimal-explained">Hexadecimal explained</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-between-number-systems">Converting between number systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#does-the-computer-see-my-dog">Does the computer see my dog?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#painting-a-picture">Painting a picture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bits">Bits</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-finger-no-thumb">One finger, no thumb</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-digital-abstraction">The digital abstraction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bits-bytes-and-nibbles">Bits, bytes, and nibbles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-a-pixel-s-color">Setting a pixel’s color</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saturation">Saturation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overflow-and-underflow">Overflow and Underflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-edges">Finding edges</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-6-do-you-see-my-dog">
<h1>Chapter 6: Do You See My Dog?<a class="headerlink" href="#chapter-6-do-you-see-my-dog" title="Permalink to this heading">#</a></h1>
<p>To this point, we have written code that required us to understand little more than the abstractions presented to us. Yet at times, we saw realities of the underlying machine through these abstractions. We learned, for example, that letters and symbols can be understood only if all parties agree on how they’re encoded. We also learned that network messages aren’t transmitted and received as an abstract whole, but are passed around in fixed-sized buffers. This need for fixed-size buffers shouldn’t be too surprising as writing a letter before the invention of email required the use of one or more fixed-sized pieces of paper. We need to remember that computers are simply tools—wonderfully flexible tools, but tools nonetheless. And as such, they do not directly manipulate our abstract ideas, but concrete <em>digital</em> representations of them.</p>
<p>In this and the following chapter, which will bring us to the end of Act I, I’ll introduce you to the digital world that underlies all modern computation. You will learn how computers represent the abstractions in our scripts, and what this means for how we go about using computers to solve our real-world problems. This will complete the foundation you need to use computation in your everyday lives.</p>
<div class="admonition-learning-outcomes admonition">
<p class="admonition-title">Learning Outcomes</p>
<p>This chapter introduces you to the digital world that underlies all modern computation. It peeks below the useful abstractions we have relied upon in the previous chapters and teaches us that computers encode everything as numbers. We’ll cover quite a bit of terminology while investigating what it takes to store a digital image and to identify objects in that image. By the chapter’s end, you will be able to:</p>
<ul class="simple">
<li><p>Describe the historical importance of numbers and how counting and measurement has been tied to knowledge and power [design];</p></li>
<li><p>Understand that computers represent aspects of our world as nothing more than arrays of numbers [CS concepts];</p></li>
<li><p>Work in Python with 1- and 2-dimensional arrays of numbers [programming skills];</p></li>
<li><p>Explain what is meant by the digital abstraction on which we build modern computing systems [CS concepts];</p></li>
<li><p>Define important terms like bit, byte, binary, and the addressing of bytes [CS concepts];</p></li>
<li><p>Interpret a sequence of bits and convert between different number systems, including hexadecimal [CS concepts];</p></li>
<li><p>Use a hexdump utility to inspect the raw contents of any file [programming skills];</p></li>
<li><p>Identify overflow and underflow conditions, and use techniques like saturation to handle them [CS concepts and design];</p></li>
<li><p>Create and work with digital images [design and programming skills];</p></li>
<li><p>Code a simple filter that when applied to an image file can highlight the edges of the objects in that image [CS concepts].</p></li>
</ul>
</div>
<section id="numbers-and-knowledge">
<p><strong>Numbers and knowledge.</strong> We are about to discover that computers encode everything as numbers. My electronic copy of this book’s manuscript is a bunch of numbers. The picture I took of my dog one weekend is stored as a bunch of numbers. The podcast I listened to on my morning walk and the songs my wife streamed on her run are simply a bunch of numbers. In fact, every file and every program on our computers are nothing but a long list of numbers.</p>
<p>That may sound very dry and unexciting, but it is also a very powerful idea. To understand why, we’re going to turn to Harvard professor and American historian Jill Lepore and her work in answering the question, what counts a knowledge?</p>
<p>There are many ways to attack this question, and I should be clear that Jill is not trying to enumerate everything that society has deemed to be knowledge. She’s been focused on identifying what society has historically used as the elemental unit of knowledge. In other words, what constitutes a fact and how is it established?</p>
<p>Jill defines a <em>fact</em> as <em>something a society establishes as true</em>.<a class="footnote-reference brackets" href="#fn1" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> Her quest then is to understand how societies establish truth. Now, we humans didn’t always rely upon ourselves for determining what was true. We spent a long time in what Jill calls <em>the age of mysticism</em>, when we believed that there were things that we could not know, or if you believe in God, that only God could know. In this age, when what was true was in dispute, people turned to trial by ordeal (or trial by combat) to allow fate or a higher power to intervene and show us what must be true. Jill reminds us that, even today, children still use this method to settle arguments of ownership. A Roshambo script implements a fairly harmless type of trial by ordeal.</p>
<p>This age of mysticism eventually gave way to <em>the age of facts</em> when, in 1215, trial by jury replaced trial by ordeal in England. In this period, truth depended upon “an observed or witnessed act or thing,”<a class="footnote-reference brackets" href="#fn2" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> and the discernment of fact involved conversations held with others. No individual alone could dictate what was true, but also no higher power was needed. We mere humans could figure out what was true for ourselves. This change in mindset was highly influential, and as Jill states, “[b]etween the thirteenth century and the nineteenth, [this approach to discerning] fact spread from law outward to science, history, and journalism.”<a class="footnote-reference brackets" href="#fn3" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p>
<p>Fast forward to the eighteenth century, and Jill notes that societies and industries began to <em>value numbers</em> as much as other types of facts. If you could enumerate or measure something, and another person could make that same tally or measurement, the result could be considered a fact. More importantly, power and prestige became intertwined with numbers. For example, the U.S., with its constitutional mandate of a regular census count, became the first government to tie its legitimacy to the act of counting. Similarly, counting was a key metric in industrialization, and measurement a key driver of science. Soon numbers and other statistics were what you needed to present in order to claim success in business and commerce.</p>
<p>Once we humans got a taste for the power of numerically-based facts, we began to develop techniques and tools to count and measure everything around us with ever-increasing accuracy. Before long, those in science, business, and government found themselves working with collections of numbers too numerous for any individual to count or analyze by hand. To address this new challenge, we invented a new type of machine—the computer—to work with these large collections of numbers—what we now call <em>data</em>.</p>
<p>Jill marks the beginning of society’s transition into valuing data with the invention of modern computers in the 1950s. Fast forward to today, and <em>data science</em>, which relies heavily on computation, permeates nearly every corner of our society. Through it, we extract meaningful insights and generate new knowledge. If you ask data scientists what they do, they’ll tell you that their objective is “to use data to answer questions and guide decision making.”<a class="footnote-reference brackets" href="#fn4" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> They are establishing what is true.</p>
<p>Given that we built our first computers to help us to crunch lots of numbers and spit out new knowledge, it’s logical that those machines store and manipulate numbers. What may be surprising, however, is that today’s computers use the same basic <em>computer architecture</em>, proposed by John von Neumann in 1945, as those original machines. In other words, at their most fundamental level (and behind all the abstractions we have discussed and all the apps you use), your laptop, smartphone, and smartwatch are simply processing numbers. Computers see the world as nothing but numbers.</p>
</section>
<section id="do-you-see-my-dog">
<p><strong>Do you see my dog?</strong> Here’s a picture I took of my dog in May of 2020.</p>
<figure class="align-default" id="c06-fig1-ref">
<img alt="_images/Smith_fig_06-01.png" src="_images/Smith_fig_06-01.png" />
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">My dog, Cosmo, lying down in our yard.</span><a class="headerlink" href="#c06-fig1-ref" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Do you see the dog in this image? Unless you’re visually impaired, of course you do. Our brains have learned over time what a dog looks like, and they help us identify dogs in the images captured by our eyes.</p>
<p>This image is stored in a file named <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code>. While we see a dog when a computer opens this file, you might ask what the computer “sees” in this image file. In particular, our new problem-to-be-solved will answer these two questions:</p>
<ol class="arabic simple">
<li><p>What is in an image file like <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code>?</p></li>
<li><p>What does it take for the computer to see the dog in that file?</p></li>
</ol>
</section>
<section id="no-interpretation-please">
<p><strong>No interpretation, please.</strong> Let’s start with the first of these two questions. When you ask a computer to open a file like <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code>, it displays a window with the image in <a class="reference internal" href="#c06-fig1-ref"><span class="std std-numref">Figure 12</span></a>. Why is that?</p>
<p>Well, what might you, as a human, guess about the file’s contents when you look at the filename <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code>? If you’ve ever worked with image files, the <em>filename extension</em> (i.e., that sequence of letters and numbers after the final period in the filename) is a great hint about what’s in the file. By convention, the extension <code class="docutils literal notranslate"><span class="pre">.jpg</span></code> means that the file contains an image encoded in the JPEG standard.<a class="footnote-reference brackets" href="#fn5" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a></p>
<p>Our computers have been programmed to do the same thing. When we double-click a file like <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code>, our computers look at the filename extension and guess that they should load the file into a program that can display JPEG images.</p>
<p>While this is normally what we want to happen, this outcome (i.e., a window containing an image) is the result of a program interpreting the contents of the image file. It doesn’t tell us what is actually stored in that file.</p>
<p>Let’s try removing the hint and see what our computer does. In other words, make a copy of <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code> and name the copy <code class="docutils literal notranslate"><span class="pre">cosmo</span></code>. Now our computer can’t use the file extension as a hint to determine what to do when opening the file. Next, let’s ask Microsoft Visual Studio Code (VS Code) to display the file <code class="docutils literal notranslate"><span class="pre">cosmo</span></code>.<a class="footnote-reference brackets" href="#fn6" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a> When we double-click the file <code class="docutils literal notranslate"><span class="pre">cosmo</span></code>, VS Code pops an alert, which tells us that “The file is not displayed in the editor because it is either binary or uses an unsupported text encoding. Do you want to open it anyway?” Putting aside what VS Code means by “binary,” we’ve learned about text encodings. Clearly VS Code peeked inside the file to see if it recognized the file as a text file in one of its known encodings. It didn’t, but for fun, let’s see what happens if it tries to interpret <code class="docutils literal notranslate"><span class="pre">cosmo</span></code> as a text file. Click “open it anyway.”</p>
<p>Yikes, this doesn’t look anything like a text file … because we know it isn’t!</p>
<p>Ok, but we don’t want VS Code to use an incorrect interpretation, we want <em>no interpretation</em>. When you say such a thing to computer scientists, they’ll reach for their favorite “hexdump” program. There’s one with that name on most Unix-based systems, and there’s an extension for VS Code that does that same work. Let’s use it now.</p>
<figure class="align-default" id="c06-fig2-ref">
<img alt="_images/Smith_fig_06-02.png" src="_images/Smith_fig_06-02.png" />
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">The start of the raw data in <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code>, as displayed by a hexdump program.</span><a class="headerlink" href="#c06-fig2-ref" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="reading-a-hexdump">
<p><strong>Reading a hexdump.</strong> <a class="reference internal" href="#c06-fig2-ref"><span class="std std-numref">Figure 13</span></a> shows the output of hexdump when it reads the file <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code>. The pairs of characters in the shaded 2-dimensional (2D) array in the middle of this figure are hexadecimal numbers corresponding to the contents of the file. Yes, the file contains nothing but lots and lots of numbers.</p>
<p>The 8-digit numbers at the left and 2-digit numbers along the top (both also in hexadecimal) exist to make it straightforward for you to determine the index of any pair of digits in the central shaded box, when you think about the contents as a long 1-dimensional (1D) sequence of pairs. For example, the first pair of hexadecimal digits in the upper left-hand shaded corner is <code class="docutils literal notranslate"><span class="pre">FF</span></code>, and this pair is given offset <code class="docutils literal notranslate"><span class="pre">00000000</span></code> (i.e., the row number plus the column number). The next pair to the right (<code class="docutils literal notranslate"><span class="pre">D8</span></code>) is given the offset <code class="docutils literal notranslate"><span class="pre">00000001</span></code>. The last pair in the first row (<code class="docutils literal notranslate"><span class="pre">48</span></code>) has offset <code class="docutils literal notranslate"><span class="pre">0000000f</span></code>, and it is followed in the file by the first pair in the second row (<code class="docutils literal notranslate"><span class="pre">00</span></code>) at offset <code class="docutils literal notranslate"><span class="pre">00000010</span></code>. In other words, while hexdump prints the file contents as a 2D array, you should think of it as a long 1D array.</p>
<p>Finally, the characters to the right of the shaded box in <a class="reference internal" href="#c06-fig2-ref"><span class="std std-numref">Figure 13</span></a> are an ASCII interpretation of each pair in the shaded box. For instance, <code class="docutils literal notranslate"><span class="pre">4A</span></code> at offset <code class="docutils literal notranslate"><span class="pre">00000006</span></code> is the letter capital-J in the ASCII text encoding.</p>
<p>We can see that this isn’t a normal text file, since most of the ASCII interpretations are the period character (<code class="docutils literal notranslate"><span class="pre">.</span></code>), which means that a pair is either: (1) really the ASCII encoding for the period character; (2) the ASCII encoding for a space character that hexdump prints as a period character; or (3) a numeric value not corresponding to any displayable ASCII character. The last case could, for example, be the ASCII value for the newline character, which we’ve expressed as <code class="docutils literal notranslate"><span class="pre">\n</span></code> in our scripts.</p>
<div class="admonition-you-try-it admonition">
<p class="admonition-title">You Try It</p>
<p><a class="reference internal" href="#c06-fig2-ref"><span class="std std-numref">Figure 13</span></a> illustrates that some pieces of our image file are actual ASCII strings. For example, you can see the string <code class="docutils literal notranslate"><span class="pre">'Apple</span> <span class="pre">iPhone'</span></code> starting at offset <code class="docutils literal notranslate"><span class="pre">000000a4</span></code>. Many file formats are structured like the messages we passed between processes in one of Chapter 5’s exercises: they include a header with extra information (called <em>metadata</em>) about the main content. In the JPEG file format, this header can include information like the type of device that took the image. As another piece of metadata, can you find the offset where the date and time on which the picture was taken is stored in the header?<a class="footnote-reference brackets" href="#fn7" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a></p>
</div>
</section>
<section id="hexadecimal-explained">
<p><strong>Hexadecimal explained.</strong> I’ve mentioned hexadecimal numbers several times over the last few chapters, and now is a good time to make sure we are all comfortable with what this exactly means.</p>
<p>Look at the top row of the hexdump in <a class="reference internal" href="#c06-fig2-ref"><span class="std std-numref">Figure 13</span></a>. The first pair (i.e., the label on the leftmost column of the shaded 2D array) is <code class="docutils literal notranslate"><span class="pre">00</span></code> and the rightmost one <code class="docutils literal notranslate"><span class="pre">0F</span></code>. Now count the number of columns. I’ll wait.</p>
<p>You should have counted to 16. A <em>hexadecimal number system</em> is one that contains 16 symbols, which correspond to the 16 symbols in the righthand digit of these 16 pairs.</p>
<p>You’ll notice that the first ten of these symbols are the same ones we use every day in the <em>decimal</em> number system: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9. The ordering here is significant in computer science for two reasons. First, you’ll often hear that computer scientists start counting from 0 (called <em>zero-based numbering</em>) because they often think in terms of an index in a sequence. We learned that we access the first element of a Python sequence with the index 0, and this zero-based numbering hints at the representation of the actual sequence in the computer’s memory. In sequences (e.g., a Python string), the first element is stored at the start of the string’s storage (i.e., at offset 0 of the storage that holds the string). Similarly, the first hexadecimal pair in our hexdump is at offset 0.</p>
<p>The second reason is simpler: Zero is a great place to start in counting if you realize that what comes before one of something is none of that thing! When we want to count something in code, we’ll want to initialize our counting variable to 0. If you don’t, you’ll be adding 1 to an unknown value in your counting variable!</p>
<p>Back to hexadecimal. “Hexa-” is a combining form that means six, and so you can think of hexadecimal as a number system with “six more things than ten.” What symbols are used for these six extra things? Well, we have run out of single digits, and so convention has us use the first six letters of the English alphabet: A, B, C, D, E, F.<a class="footnote-reference brackets" href="#fn8" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a></p>
<p>Our hexdump illustrates this way of counting in action. The first item in the hexdump sequence is <code class="docutils literal notranslate"><span class="pre">FF</span></code> and is accessed with the index <code class="docutils literal notranslate"><span class="pre">0</span></code>. The second is <code class="docutils literal notranslate"><span class="pre">D8</span></code> and is accessed with the index <code class="docutils literal notranslate"><span class="pre">1</span></code>. Those indices are the same in both decimal and hexadecimal, and they continue to be the same up through index <code class="docutils literal notranslate"><span class="pre">9</span></code> (the second instance of the item with value <code class="docutils literal notranslate"><span class="pre">46</span></code>). How we write the next index after <code class="docutils literal notranslate"><span class="pre">9</span></code> depends on which base we’re using to count. Decimal is a base-10 system (i.e., it uses 10 symbols), while hexadecimal is a base-16 system (i.e., it uses 16 symbols). As such, the next item in the hexdump (i.e., the second <code class="docutils literal notranslate"><span class="pre">00</span></code> in the first shaded row) is index <code class="docutils literal notranslate"><span class="pre">10</span></code> in base-10 and <code class="docutils literal notranslate"><span class="pre">A</span></code> in base-16. The first item in the second row of the hexdump (<code class="docutils literal notranslate"><span class="pre">00</span></code> again) is index <code class="docutils literal notranslate"><span class="pre">16</span></code> in base-10 and <code class="docutils literal notranslate"><span class="pre">10</span></code> in base-16. And so forth.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The way that the 1D sequence is laid out in the displayed 2D array makes it so that adding a row’s offset value to a column’s never requires you to do a carry. In fact, the last digit of the column’s offset value just replaces the final zero of the row’s offset value!</p>
</div>
<p>You may have learned that 10 in base-10 represents <span class="math notranslate nohighlight">\(1*10^1 + 0*10^0\)</span> where each digit gets multiplied by the base raised to the position of that digit counting from the right (and starting with 0).</p>
<p>Knowing this, what then do you think 10 is in base-16? Using the approach that helped us understand base-10, it would be <span class="math notranslate nohighlight">\(1*16^1 + 0*16^0 = 16_{10}\)</span>. We place a subscript-10 on the 16 to remind us that we’re now back in base-10.</p>
<div class="admonition-you-try-it admonition">
<p class="admonition-title">You Try It</p>
<p>What is the index, in hexadecimal, for the first occurrence of the value <code class="docutils literal notranslate"><span class="pre">1B</span></code> in the hexdump of <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code>? What is the decimal value of that index?<a class="footnote-reference brackets" href="#fn9" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a></p>
</div>
</section>
<section id="converting-between-number-systems">
<p><strong>Converting between number systems.</strong> You should take the time to completely understand how to convert back and forth between base-10 and base-16 representations. If you have any questions at this point, there are many resources online that can help. But once you understand how to do this work, you can use the Python interpreter to do the grunt work of converting numbers between different bases. Remember that computers are built to do numerical work!</p>
<p>To convert a number in another base, like 16, to decimal, you simply need to evaluate <code class="docutils literal notranslate"><span class="pre">int('11e',</span> <span class="pre">base=16)</span></code>, where <code class="docutils literal notranslate"><span class="pre">'11e'</span></code> is replaced by the number you want converted. Notice that the hexadecimal number is specified as a string.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span><span class="p">(</span><span class="s1">&#39;11e&#39;</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to know the hexadecimal value of a decimal number, say 286, you execute <code class="docutils literal notranslate"><span class="pre">hex(286)</span></code>, where <code class="docutils literal notranslate"><span class="pre">hex</span></code> is a Python built-in function that takes a single integer argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">hex</span><span class="p">(</span><span class="mi">286</span><span class="p">)</span>
</pre></div>
</div>
<p>When you run the hex command, you’ll see that the Python interpreter prepended the string <code class="docutils literal notranslate"><span class="pre">'0x'</span></code> to the hexadecimal equivalent of 286. This prefix is how you and the interpreter know that the string represents a number in base-16, not base-10.</p>
</section>
<section id="does-the-computer-see-my-dog">
<p><strong>Does the computer see my dog?</strong> While we can see that the bunch of numbers saved in <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code> and then displayed as an image contains a dog, can the computer recognize that there’s a dog in this sea of numbers? Short answer, yes, with the help of machine learning (ML), which we will discuss in Chapter 17. If you have a phone that unlocks with facial recognition, you’re already using this technology in your daily life. For now, we can get an idea of how this works, and importantly learn that the work going on in the bowels of our computers is really nothing more than math on numbers.</p>
<p>To work with images, we are going to use a very handy library called PIL, the Python Imaging Library.<a class="footnote-reference brackets" href="#fn10" id="id10" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a> This library includes support for a wide range of file formats, including JPEG, and it allows us to write only a few lines of code to perform an extensive set of image processing tasks.</p>
<p>For example, similar to what we did when we read the text files containing the story of <em>The Cat In Hat</em>, we will use the <code class="docutils literal notranslate"><span class="pre">Image.open</span></code> method to read the image data into an <code class="docutils literal notranslate"><span class="pre">Image</span></code> object, which I’ve named <code class="docutils literal notranslate"><span class="pre">im</span></code> in <code class="docutils literal notranslate"><span class="pre">edges.py</span></code>. After processing this image, our scripts will write out the new image to a file called <code class="docutils literal notranslate"><span class="pre">out.png</span></code> using the <code class="docutils literal notranslate"><span class="pre">Image.save</span></code> method. Feel free to change the filename and file extension; the extension tells the PIL in which format to write. To see the resulting image, simply open the saved file as you would with any image file (e.g., double-click the file).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">### chap06/edges.py</span>
<span class="linenos">2</span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageFilter</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="n">imfile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Name of imagefile: &#39;</span><span class="p">)</span>
<span class="linenos">5</span>
<span class="linenos">6</span><span class="k">with</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;images/&#39;</span> <span class="o">+</span> <span class="n">imfile</span><span class="p">)</span> <span class="k">as</span> <span class="n">im</span><span class="p">:</span>
<span class="linenos">7</span>    <span class="c1"># Apply a filter that detects edges</span>
<span class="linenos">8</span>    <span class="n">filtered</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ImageFilter</span><span class="o">.</span><span class="n">CONTOUR</span><span class="p">)</span>
<span class="linenos">9</span>    <span class="n">filtered</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;images/out.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Image</span></code> objects have many methods. To highlight the edges, or contours, of the things in an image, we apply a convolution filter.<a class="footnote-reference brackets" href="#fn11" id="id11" role="doc-noteref"><span class="fn-bracket">[</span>11<span class="fn-bracket">]</span></a></p>
<div class="admonition-you-try-it admonition">
<p class="admonition-title">You Try It</p>
<p>Run <code class="docutils literal notranslate"><span class="pre">edges.py</span></code> and input <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code>. After the script has run, in <code class="docutils literal notranslate"><span class="pre">out.png</span></code> you’ll see that the application of this filter (i.e., a mathematical transform of the numbers in <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code>) nicely outlines my dog.</p>
</div>
</section>
<section id="painting-a-picture">
<p><strong>Painting a picture.</strong> To understand what took place when we ran a convolution filter, we are going to use the PIL to build a very simple image that contains a single edge and then write a few lines of Python code to detect that edge. The script <code class="docutils literal notranslate"><span class="pre">edge1.py</span></code> gets us started.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">### chap06/edge1.py</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># Width and height of our image</span>
<span class="linenos"> 5</span><span class="n">sz</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1"># Create a single plane of grayscale pixels, initialized to black</span>
<span class="linenos"> 8</span><span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">sz</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1"># Create direct access to the pixels in the image</span>
<span class="linenos">11</span><span class="n">pixels</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="c1"># Set the color of each pixel</span>
<span class="linenos">14</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<span class="linenos">15</span>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<span class="linenos">16</span>        <span class="c1"># Creates a diagonal fade</span>
<span class="linenos">17</span>        <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="n">im</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;images/out.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This script begins by creating a new <code class="docutils literal notranslate"><span class="pre">Image</span></code> object that contains a 2D array of size 100x100, as specified by the second parameter to the <code class="docutils literal notranslate"><span class="pre">Image.new</span></code> call.<a class="footnote-reference brackets" href="#fn12" id="id12" role="doc-noteref"><span class="fn-bracket">[</span>12<span class="fn-bracket">]</span></a> This 2D array is the canvas on which we’ll paint our image. However, unlike a picture we create with a paint brush, the picture we will build is more like one from a paint-by-number kit, where each element in this 2D array is of a fixed size and painted with a single color. Every picture we take with a digital camera is created in this way, and each element in the 2D array that comprises a digital picture is called a <em>pixel</em>, which is short for picture element.</p>
<p>Pixels come in different ranges of colors. Our script asked the <code class="docutils literal notranslate"><span class="pre">Image</span></code> module for pixels that can be colored with one of 256 different shades of gray, where <code class="docutils literal notranslate"><span class="pre">0</span></code> represents pure black and <code class="docutils literal notranslate"><span class="pre">255</span></code> pure white. This is what the first parameter, called the <em>mode</em>, to the <code class="docutils literal notranslate"><span class="pre">Image.new</span></code> call specifies when passed with the string value <code class="docutils literal notranslate"><span class="pre">'L'</span></code>. In an exercise, you will change this mode to <code class="docutils literal notranslate"><span class="pre">'RGB'</span></code> so that you can build pictures with a rainbow of colors. In RGB mode, the number <code class="docutils literal notranslate"><span class="pre">0</span></code> still represents pure black, but we now have more than 16.7 million colors between the color black and the color white (16,777,216 colors in total to be exact). As a last example, we might have specified the mode <code class="docutils literal notranslate"><span class="pre">'1'</span></code>, which encodes pure black as the number <code class="docutils literal notranslate"><span class="pre">0</span></code> and pure white as the number <code class="docutils literal notranslate"><span class="pre">1</span></code>. In this mode, you have only two colors in your palette.<a class="footnote-reference brackets" href="#fn13" id="id13" role="doc-noteref"><span class="fn-bracket">[</span>13<span class="fn-bracket">]</span></a></p>
</section>
<section id="bits">
<p><strong>Bits.</strong> Each of these modes has two things in common: <code class="docutils literal notranslate"><span class="pre">0</span></code> represents black; and the total number of colors between black and white, inclusive, is a power of 2. This makes the encoding for white to be <span class="math notranslate nohighlight">\(2^{numberOfEncodingBits} - 1\)</span> in each of these modes.</p>
<p>A <em>bit</em> is the most elemental unit of storage in our computing systems. It represents a single digit in the base-2 numbering system, also called <em>binary</em> numbers. With a single bit, the value of this binary number is either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>. The value <code class="docutils literal notranslate"><span class="pre">2</span></code> (base-10) is encoded as <code class="docutils literal notranslate"><span class="pre">10</span></code> (base-2), following the same reasoning we used when we discussed base-10 and base-16 numbering. As an illustration, <a class="reference internal" href="#c06-fig3-ref"><span class="std std-numref">Figure 14</span></a> counts from 0 to 19 in each of the bases 10, 2, and 16.</p>
<figure class="align-default" id="c06-fig3-ref">
<img alt="_images/Smith_fig_06-03.png" src="_images/Smith_fig_06-03.png" />
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">A listing of how the numbers from 0 to 19 are written in the bases commonly used in computing. Notice that a new digit is added when the count equals the base (shaded boxes).</span><a class="headerlink" href="#c06-fig3-ref" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Great, but you might be wondering why computers use binary numbering. You might claim that hexdump didn’t display the numbers contained in my JPEG file in base-2. Yes, that’s true about hexdump, but this was a usability design decision that the creators of hexdump made.</p>
<p>To understand this design decision, answer the following question: For which of the following pairs of numbers is it easier for you, a human, to tell that the two values in the pair are not the same: <code class="docutils literal notranslate"><span class="pre">11011000</span></code> and <code class="docutils literal notranslate"><span class="pre">11011100</span></code>, or <code class="docutils literal notranslate"><span class="pre">D8</span></code> and <code class="docutils literal notranslate"><span class="pre">DA</span></code>? I’ll guess that you’ll say the latter, and this difference in ability only increases as the number of digits you’re scanning increases.</p>
<p>Hexdump uses base-16 because it is easier to read hex numbers and a straightforward process to convert back and forth between base-2 and base-16. Starting from the righthand end of a base-2 number, you group together the rightmost four bits and convert them into a single hexadecimal digit. You then grab the next four bits and repeat until you run out of bits. For example, <code class="docutils literal notranslate"><span class="pre">11011000</span></code> becomes <code class="docutils literal notranslate"><span class="pre">1101</span> <span class="pre">1000</span></code>, which becomes <code class="docutils literal notranslate"><span class="pre">D</span> <span class="pre">8</span></code>, which we can push back together as <code class="docutils literal notranslate"><span class="pre">D8</span></code>. (Feel free to run the process in reverse, when needed.) When you understand this, I hope you realize that hexdump is showing us the bits in the JPEG file.<a class="footnote-reference brackets" href="#fn14" id="id14" role="doc-noteref"><span class="fn-bracket">[</span>14<span class="fn-bracket">]</span></a></p>
</section>
<section id="one-finger-no-thumb">
<p><strong>One finger, no thumb.</strong> The careful reader will interrupt at this time and point out that I still haven’t told you why computers store numbers with binary digits and not, say, decimal digits. A simple answer is that humans learned to count using their fingers, and since most of us have 10 fingers, base-10 numbering comes naturally to us. Computers don’t have any fingers, and what is natural for them is sensing the difference between on and off.</p>
<p>If you take a course in digital logic design, you’ll learn that modern computers, and most every piece of logic in them, are built from very simple switches, which are either on or off. Yes, these switches are like the light switches in your home. Flip the switch up and the light goes on; flip it down and the light goes off. From this incredibly simple switch, we can build the large memories and fast processors found in the smartphones we hold in our hands, the laptop computers on our desks, and the corporate servers in the cloud.</p>
</section>
<section id="the-digital-abstraction">
<p><strong>The digital abstraction.</strong> When we build smartphones, computers, and servers from circuitry that acts like simple switches, we call the result a <em>digital</em> device. This nomenclature reminds us that we are relying on another abstraction boundary: <em>the digital abstraction</em>.</p>
<p>What a digital circuit senses as “on” (or a <code class="docutils literal notranslate"><span class="pre">1</span></code> value) is a real-world value (called an <em>analog</em> or <em>continuous</em> value) somewhere near the ideal “on” value. You can think of this as the rounding we learned in grade school. We might measure some length as 1.03 miles, and we round it to 1 mile when all we care about is roughly how many miles it is from my home to my grandmother’s house. Similarly, a value of 0.042 miles is rounded to 0 miles.</p>
<div class="admonition-you-try-it admonition">
<p class="admonition-title">You Try It</p>
<p>How should we treat a measurement is 0.47 miles? Should we treat it as 1 mile or 0 miles? In other words, should we round this value up or down?<a class="footnote-reference brackets" href="#fn15" id="id15" role="doc-noteref"><span class="fn-bracket">[</span>15<span class="fn-bracket">]</span></a></p>
</div>
<p>The magic of digital circuits is this ability to ignore, and in fact avoid accumulating, a certain amount of imprecision away from the ideal values.<a class="footnote-reference brackets" href="#fn16" id="id16" role="doc-noteref"><span class="fn-bracket">[</span>16<span class="fn-bracket">]</span></a> Because of this magical property of digital circuits, we can pretend, for example, that the file <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code> in my computer’s memory, or in a solid state drive, or on a magnetic hard drive, or being transmitted across the Internet is just a bunch of binary numbers, even though the first <code class="docutils literal notranslate"><span class="pre">1</span></code> value in the file is not actually exactly <code class="docutils literal notranslate"><span class="pre">1</span></code> (or the same exact value) on any of those mentioned media.</p>
</section>
<section id="bits-bytes-and-nibbles">
<p><strong>Bits, bytes, and nibbles.</strong> With this new knowledge, let’s return to our <code class="docutils literal notranslate"><span class="pre">edge1.py</span></code> script. The code creates a 100x100 2D-array of pixels, and each pixel can contain one of 256 shades of gray. 256 is <span class="math notranslate nohighlight">\(2^8\)</span>, which explains why <code class="docutils literal notranslate"><span class="pre">'L'</span></code> is described on the documentation page<a class="footnote-reference brackets" href="#fn17" id="id17" role="doc-noteref"><span class="fn-bracket">[</span>17<span class="fn-bracket">]</span></a> as “8-bit pixels, grayscale.”</p>
<p>Eight bits grouped together occurs so frequently in computer science that this grouping is given its own name: a <em>byte</em>. If you look back at the hexdump, you’ll notice that this is what hexdump is indexing. <code class="docutils literal notranslate"><span class="pre">FF</span></code> is the value of the first byte in <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code>; <code class="docutils literal notranslate"><span class="pre">D8</span></code> is the value of the second byte.</p>
<p>You might also hear the term <em>nibble</em>, which is half a byte or 4 bits. Half a byte like <code class="docutils literal notranslate"><span class="pre">D8</span></code> is simply one of the hexadecimal characters.</p>
<p>You’ll also recognize the term byte from the unit of size in which you buy computer memory or hard-drive storage. My laptop has 16 GB, or 16 gigabytes, of memory, where giga- means <span class="math notranslate nohighlight">\(10^9\)</span>. In other words, my laptop has a little bit more than 16 billion bytes of memory.<a class="footnote-reference brackets" href="#fn18" id="id18" role="doc-noteref"><span class="fn-bracket">[</span>18<span class="fn-bracket">]</span></a></p>
</section>
<section id="setting-a-pixel-s-color">
<p><strong>Setting a pixel’s color.</strong> By default, <code class="docutils literal notranslate"><span class="pre">Image.new</span></code> sets each pixel in our created 2D array to the color black. Why black? Because this default is easy. Every mode defines black as <code class="docutils literal notranslate"><span class="pre">0</span></code>, and if we fill the 2D array with zeros everywhere, we get a completely black picture.</p>
<p>To make a more interesting image, <code class="docutils literal notranslate"><span class="pre">edge1.py</span></code> contains a pair of nested for-loops (lines 14-17) that paints each pixel in the <code class="docutils literal notranslate"><span class="pre">Image</span></code> object’s 2D array of pixels with a color of our choosing. To access the image’s individual pixels, the script calls the <code class="docutils literal notranslate"><span class="pre">Image.load</span></code> method (line 11), which returns an object that supports the Python indexing syntax (i.e., square brackets).</p>
<p>With this <code class="docutils literal notranslate"><span class="pre">pixels</span></code> array in hand, the script uses the nested for-loops (lines 14-15) to produce an index <code class="docutils literal notranslate"><span class="pre">i,j</span></code>, which I’ll write as <code class="docutils literal notranslate"><span class="pre">[i,j]</span></code>, that allows us to set the color of each pixel. The color chosen for each pixel is determined by a simple summation of the two index values.</p>
<p>What kind of picture will this create? The first iteration of the outer loop sets <code class="docutils literal notranslate"><span class="pre">i</span></code> to <code class="docutils literal notranslate"><span class="pre">0</span></code> and then its body runs the first iteration of the inner loop, which sets <code class="docutils literal notranslate"><span class="pre">j</span></code> to <code class="docutils literal notranslate"><span class="pre">0</span></code>. The inner loop’s body then sets the pixel at <code class="docutils literal notranslate"><span class="pre">[0,0]</span></code> to the value <code class="docutils literal notranslate"><span class="pre">0</span></code>, which is the encoding for the color black.</p>
<p>But which pixel in the 2D <code class="docutils literal notranslate"><span class="pre">pixels</span></code> array is the pixel at <code class="docutils literal notranslate"><span class="pre">[0,0]</span></code>? If you read the PIL documentation, it says that <code class="docutils literal notranslate"><span class="pre">[0,0]</span></code> is defined to be the upper lefthand corner of the image. There’s nothing special about this choice other than that’s how the code in the library has been designed to work.</p>
<p>We’ll learn more in the next chapter about how a nested loop structure causes us to move through the pixels in an image, but for now, we only care that, as we move right and down in the <code class="docutils literal notranslate"><span class="pre">pixels</span></code> array, we will store ever larger sums, which in our color palette moves us closer to the color white. So, it sounds like this script will produce an image with a diagonal fade, from black in the upper lefthand corner to white in the lower righthand corner.</p>
<div class="admonition-you-try-it admonition">
<p class="admonition-title">You Try It</p>
<p>Run <code class="docutils literal notranslate"><span class="pre">edge1.py</span></code> and see that it does produce an image with a diagonal fade.</p>
</div>
</section>
<section id="saturation">
<p><strong>Saturation.</strong> Let’s try making a bigger image using our simple method for creating a diagonal fade. In particular, let’s change the value of <code class="docutils literal notranslate"><span class="pre">sz</span></code> from <code class="docutils literal notranslate"><span class="pre">(100,</span> <span class="pre">100)</span></code> to <code class="docutils literal notranslate"><span class="pre">(400,</span> <span class="pre">400)</span></code> and re-run the script.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">### chap06/edge2.py</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># Width and height of our image</span>
<span class="linenos"> 5</span><span class="n">sz</span> <span class="o">=</span> <span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1"># Create a single plane of grayscale pixels, initialized to black</span>
<span class="linenos"> 8</span><span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">sz</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1"># Create direct access to the pixels in the image</span>
<span class="linenos">11</span><span class="n">pixels</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="c1"># Set the color of each pixel</span>
<span class="linenos">14</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<span class="linenos">15</span>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<span class="linenos">16</span>        <span class="c1"># Creates a diagonal fade</span>
<span class="linenos">17</span>        <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="n">im</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;images/out.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Our desired fade appears only in the upper lefthand corner of the generated image. Why is that do you suppose?</p>
<p>Perhaps we can start to figure this out if we look at the values stored in the <code class="docutils literal notranslate"><span class="pre">pixels</span></code> array after the work done by the nested-for loop. In particular, let’s print the value of the last pixel in our image, whose value is stored at <code class="docutils literal notranslate"><span class="pre">pixels[399,</span> <span class="pre">399]</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pixels</span><span class="p">[</span><span class="mi">399</span><span class="p">,</span> <span class="mi">399</span><span class="p">])</span>
</pre></div>
</div>
<p>Its value is <code class="docutils literal notranslate"><span class="pre">255</span></code>. What value did we try to write into that pixel? It should have been 399 + 399 or 798. Why did 798 become 255? In fact, if you look at every pixel beyond the diagonal where <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">+</span> <span class="pre">j</span></code> becomes equal to <code class="docutils literal notranslate"><span class="pre">255</span></code>, you will find that the value of those pixels is <code class="docutils literal notranslate"><span class="pre">255</span></code>.</p>
<p>Here’s a hint: What did we say about the pixels in our image when we created the image object? Yes, we said that the image would be full of <em>8-bit</em> pixels. What is the biggest decimal number we can represent with 8 binary bits? Well, what is <code class="docutils literal notranslate"><span class="pre">11111111</span></code> in decimal? Go ahead and ask the Python interpreter to evaluate the following expression:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span><span class="p">(</span><span class="s1">&#39;11111111&#39;</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>So, what has the assignment done when we asked it to store a number bigger than 255? Right! It simply stored the biggest number it could. This is called <em>saturation</em>. It is equivalent to the functionality of the volume circuitry on your cell phone: You can keep pushing the volume-up button, but eventually the volume hits its maximum value and stays there no matter how many more times you hit volume-up.</p>
<p>What do you think will happen if we try to store <code class="docutils literal notranslate"><span class="pre">-1</span></code> in <code class="docutils literal notranslate"><span class="pre">pixels[399,</span> <span class="pre">399]</span></code>? Right again! No matter how many times you push volume-down, you can’t get your volume to go any lower than 0 or off.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pixels</span><span class="p">[</span><span class="mi">399</span><span class="p">,</span> <span class="mi">399</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pixels</span><span class="p">[</span><span class="mi">399</span><span class="p">,</span> <span class="mi">399</span><span class="p">])</span>
</pre></div>
</div>
<p>Putting this all together, we asked the PIL to create an image of 400-by-400 pixels where each pixel held an 8-bit value between 0 (black) and 255 (white). It kept us to this by (silently) making sure that the image’s pixel array never contained any values outside this range. When we tried to store a value greater than 255 or less than 0, it “saturated” that value at either 0 or 255.</p>
</section>
<section id="overflow-and-underflow">
<p><strong>Overflow and Underflow.</strong> Many programming languages allow you to define a variable and specify that it can contain only integer values between 0 and 255. A computer scientist would say that such a variable has the type <em>unsigned byte</em>. The word byte indicates that we need only 8 bits to represent every possible unique value, and the word unsigned means that the values should be interpreted as all greater than or equal to zero. This exactly describes the encoding we use for 8-bit, grayscale pixels.</p>
<p>We will learn more about the benefits of types, but for now, I want to introduce you to the ways that different programming languages might handle an operation that produces a value that doesn’t fit into an unsigned byte.</p>
<p>Take, for example, the situation with which we’ve been dealing: the addition of two 8-bit, grayscale pixels. As we’ve learned, this addition might produce a value greater than 255, for which we have no 8-bit representation. In general, computer scientists say that the addition <em>overflowed</em> its representation (or just overflowed for short). Similarly, a subtraction may <em>underflow</em>, by producing a value less than the smallest allowed representation. Saturation is one way of “correcting” these situations. In our current problem-to-be-solved, it is a sensible solution because we’re working with image pixels and there’s nothing blacker than black or whiter than white.</p>
<p>More generally, a running program may not know that a variable represents an 8-bit, grayscale pixel, but only that the variable’s physical representation is an unsigned byte. In this case, saturation may not be the right action to take. Instead, a better action might be to raise an exception.</p>
<p>We’ve seen several types of exceptions, and they are ways for a running program to indicate that something happened that it doesn’t know how to handle. If your script doesn’t register a way to handle an exceptional event, the event will terminate the running instance of your script.</p>
<p>Sometimes, the designer of a programming language will choose to ignore particular kinds of overflow and underflow. For example, addition on unsigned integers in the C programming language never, by definition, overflows. If you add two unsigned, 8-bit numbers in C, the result is the sum of the two numbers modulo 256. In other words, unsigned addition in C is like adding on an analog clock face: when you add one to the biggest number on the clock face, you find yourself at the smallest number on the clock face. Another way to think about C’s unsigned add is that you perform the addition and then lop off the most significant bits that don’t fit in the physical representation. All of these, of course, are just different ways of describing the concept of Modulo arithmetic.</p>
</section>
<section id="finding-edges">
<p><strong>Finding edges.</strong> We are FINALLY ready to build a picture containing an edge and then do some simple math to highlight that edge’s location in the image.</p>
<p>The script <code class="docutils literal notranslate"><span class="pre">edge3.py</span></code> builds two images. In the first (called <code class="docutils literal notranslate"><span class="pre">im</span></code>), it sets the color of all columns in the image array with indices below 25 to black and the rest to white, which creates a vertical boundary between the black and white areas. The second image (called <code class="docutils literal notranslate"><span class="pre">filtered</span></code>) computes each of its pixel values by performing some math using a selected group of the pixels in <code class="docutils literal notranslate"><span class="pre">im</span></code>, as I’ll explain in detail in a moment.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">### chap06/edge3.py</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># Width and height of our image</span>
<span class="linenos"> 5</span><span class="n">sz</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1"># Create a single plane of grayscale pixels, initialized to black.</span>
<span class="linenos"> 8</span><span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">sz</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1"># Create direct access to the pixels in the image</span>
<span class="linenos">11</span><span class="n">pixels</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="c1"># Set the color of each pixel</span>
<span class="linenos">14</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<span class="linenos">15</span>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<span class="linenos">16</span>        <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">25</span> <span class="k">else</span> <span class="mi">255</span>    <span class="c1"># vertical boundary</span>
<span class="linenos">17</span>        <span class="c1"># pixels[i,j] = 0 if j &lt; 25 else 255    # horizontal boundary</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="c1"># Save initial image</span>
<span class="linenos">20</span><span class="n">filtered</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">images</span><span class="o">/</span><span class="n">out_orig</span><span class="o">.</span><span class="n">png</span><span class="p">)</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="c1"># Create a new B&amp;W image into which we&#39;ll put the filtered result</span>
<span class="linenos">23</span><span class="n">filtered</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">sz</span><span class="p">)</span>
<span class="linenos">24</span><span class="n">fpixels</span> <span class="o">=</span> <span class="n">filtered</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="c1"># Apply an edge-detection convolution (it&#39;s just math for B&amp;W only!)</span>
<span class="linenos">27</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="linenos">28</span>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">sz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="linenos">29</span>        <span class="n">fpixels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span>  <span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> 
<span class="linenos">30</span>                        <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">pixels</span><span class="p">[</span><span class="n">i</span>  <span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> 
<span class="linenos">31</span>                        <span class="n">pixels</span><span class="p">[</span><span class="n">i</span>  <span class="p">,</span><span class="n">j</span>  <span class="p">]</span> <span class="o">*</span>  <span class="mi">8</span> <span class="o">+</span> 
<span class="linenos">32</span>                        <span class="n">pixels</span><span class="p">[</span><span class="n">i</span>  <span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> 
<span class="linenos">33</span>                        <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span>  <span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">34</span>
<span class="linenos">35</span><span class="c1"># Save resulting image</span>
<span class="linenos">36</span><span class="n">filtered</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">images</span><span class="o">/</span><span class="n">out_filtered</span><span class="o">.</span><span class="n">png</span><span class="p">)</span>
</pre></div>
</div>
<p>The script creates the first image using the syntax for Python’s conditional-assignment statement (line 16). The statement might look intimidating at first, but you’ll get it if you take the statement a piece at a time: <code class="docutils literal notranslate"><span class="pre">pixels[i,j]</span></code> is set to the value <code class="docutils literal notranslate"><span class="pre">0</span></code> if the condition is <code class="docutils literal notranslate"><span class="pre">True</span></code>; otherwise it is set to <code class="docutils literal notranslate"><span class="pre">255</span></code>. The condition in the statement is <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">&lt;</span> <span class="pre">25</span></code>, but it could be anything that evaluates to <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>After saving this initial image <code class="docutils literal notranslate"><span class="pre">im</span></code>, the script then creates an entirely-black <code class="docutils literal notranslate"><span class="pre">filtered</span></code> image of the same size as <code class="docutils literal notranslate"><span class="pre">im</span></code>. The interesting work is in the body of the second nested for-loops, which you can think about as computation that uses a sliding window with 9 panes of glass organized as 3 rows of 3 columns. The script centers this 3x3 window over a <code class="docutils literal notranslate"><span class="pre">[i,j]</span></code> pixel in <code class="docutils literal notranslate"><span class="pre">im</span></code> and uses the values of the window’s pixels to compute the color of the <code class="docutils literal notranslate"><span class="pre">[i,j]</span></code> pixel in <code class="docutils literal notranslate"><span class="pre">filtered</span></code>.<a class="footnote-reference brackets" href="#fn19" id="id19" role="doc-noteref"><span class="fn-bracket">[</span>19<span class="fn-bracket">]</span></a></p>
<p><a class="reference internal" href="#c06-fig4-ref"><span class="std std-numref">Figure 15</span></a> illustrates the work of this second pair of nested for-loops (lines 27-28). The <code class="docutils literal notranslate"><span class="pre">pixels</span></code> image in the figure is like our script’s <code class="docutils literal notranslate"><span class="pre">im</span></code> image except that we switch from black to white after three columns (not 25). The <code class="docutils literal notranslate"><span class="pre">fpixels</span></code> image is the result of the <code class="docutils literal notranslate"><span class="pre">fpixels</span></code> computation on lines 29-33 for each <code class="docutils literal notranslate"><span class="pre">[i,j]</span></code> pixel. I’ve drawn the 3x3 sliding window over a pixel <code class="docutils literal notranslate"><span class="pre">[i,j]</span></code> and shown the computation that takes place. This computation produces a value of -765, which is saturated to <code class="docutils literal notranslate"><span class="pre">0</span></code> (black).<a class="footnote-reference brackets" href="#fn20" id="id20" role="doc-noteref"><span class="fn-bracket">[</span>20<span class="fn-bracket">]</span></a></p>
<figure class="align-default" id="c06-fig4-ref">
<img alt="_images/Smith_fig_06-04.png" src="_images/Smith_fig_06-04.png" />
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">An illustration of the sliding window computation in <code class="docutils literal notranslate"><span class="pre">edge3.py</span></code> that highlights the boundaries of an object (like a dog) in a digital image.</span><a class="headerlink" href="#c06-fig4-ref" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Now think about this computation when every pixel in the 3x3 sliding window is the same color: the heavy weighting on the <code class="docutils literal notranslate"><span class="pre">[i,j]</span></code> pixel exactly cancels the summed weighting of the surrounding eight pixels. The computed value is <code class="docutils literal notranslate"><span class="pre">0</span></code>, and the <code class="docutils literal notranslate"><span class="pre">[i,j]</span></code> pixel in the filtered image is painted black.</p>
<p>However, when the leftmost column of the sliding window of pixels is black and the rightmost two columns are white (i.e., slide the window in <a class="reference internal" href="#c06-fig4-ref"><span class="std std-numref">Figure 15</span></a> one column to the right), the computation produces the value 8 * 255 - 5 * 255 = 765. Of course, saturation occurs and the pixel is painted with the value <code class="docutils literal notranslate"><span class="pre">225</span></code> (white).</p>
<div class="admonition-you-try-it admonition">
<p class="admonition-title">You Try It</p>
<p>Run <code class="docutils literal notranslate"><span class="pre">edge3.py</span></code>, and you’ll see that the filtered image contains a white line where the edge between the black and white regions were in the original image—like the <code class="docutils literal notranslate"><span class="pre">fpixels</span></code> image in <a class="reference internal" href="#c06-fig4-ref"><span class="std std-numref">Figure 15</span></a>. Comment line 16 and uncomment line 17 to switch from a vertical to a horizontal edge; the computation handles a boundary of any orientation.</p>
</div>
<p>You have now done all that the <code class="docutils literal notranslate"><span class="pre">ImageFilter</span></code> library did when our code in <code class="docutils literal notranslate"><span class="pre">edges.py</span></code> applied a <code class="docutils literal notranslate"><span class="pre">CONTOUR</span></code> filter. In this way, a computer can highlight the dog-shaped blob in <code class="docutils literal notranslate"><span class="pre">cosmo.jpg</span></code>. Knowing that that blob looks like a dog requires machine learning, a topic for later.</p>
<hr class="footnotes docutils" />
<aside class="footnote brackets" id="fn1" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Jill Lepore,”After the Fact,” <em>The New Yorker</em> (March 14, 2016). <a class="reference external" href="https://www.newyorker.com/magazine/2016/03/21/the-internet-of-us-and-the-end-of-facts">https://www.newyorker.com/magazine/2016/03/21/the-internet-of-us-and-the-end-of-facts</a></p>
</aside>
<aside class="footnote brackets" id="fn2" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Ibid.</p>
</aside>
<aside class="footnote brackets" id="fn3" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>Ibid.</p>
</aside>
<aside class="footnote brackets" id="fn4" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p>Quoted from Allen Downey in multiple of his online talks and writing. I originally found it in an early edition of <em>Elements of Data Science</em> (Online edition). <a class="reference external" href="https://allendowney.github.io/ElementsOfDataScience/README.html">https://allendowney.github.io/ElementsOfDataScience/README.html</a></p>
</aside>
<aside class="footnote brackets" id="fn5" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">5</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://docs.fileformat.com/image/jpeg/">https://docs.fileformat.com/image/jpeg/</a></p>
</aside>
<aside class="footnote brackets" id="fn6" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">6</a><span class="fn-bracket">]</span></span>
<p>You should be able to do this in any IDE.</p>
</aside>
<aside class="footnote brackets" id="fn7" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">7</a><span class="fn-bracket">]</span></span>
<p>The date starts at offset 000000CC. The picture was taken at 3:39pm on May 19, 2020.</p>
</aside>
<aside class="footnote brackets" id="fn8" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">8</a><span class="fn-bracket">]</span></span>
<p>Gottfried Wilhelm Leibniz, an inventor of calculus, is credited with the invention of base-16 numbering, and he anticipated the use of the characters `a-f` as symbols for the base’s extra digits. Lloyd Strickland and Harry Lewis, <em>Leibniz on Binary: The Invention of Computer Arithmetic</em> (Cambridge, MA: MIT Press, 2022), 6.</p>
</aside>
<aside class="footnote brackets" id="fn9" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">9</a><span class="fn-bracket">]</span></span>
<p>The first 1B hexadecimal pair in the hexdump is at offset 59 (base 16). This hexadecimal offset has a decimal value of 89 (base 10).</p>
</aside>
<aside class="footnote brackets" id="fn10" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id10">10</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://pillow.readthedocs.io/en/stable/handbook/overview.html">https://pillow.readthedocs.io/en/stable/handbook/overview.html</a></p>
</aside>
<aside class="footnote brackets" id="fn11" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id11">11</a><span class="fn-bracket">]</span></span>
<p>If you don’t know what a convolution filter is, you will in a few moments. Keep reading!</p>
</aside>
<aside class="footnote brackets" id="fn12" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id12">12</a><span class="fn-bracket">]</span></span>
<p>The second parameter to the `Image.new` call is `sz`, which is a tuple defined on line 5. Recall that you can think of a tuple as a box in which you store several objects and access these objects by indexing.</p>
</aside>
<aside class="footnote brackets" id="fn13" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id13">13</a><span class="fn-bracket">]</span></span>
<p>See the PIL Modes page for a full mapping of mode codes to pixel types and depths. <a class="reference external" href="https://pillow.readthedocs.io/en/stable/handbook/concepts.html#concept-modes">https://pillow.readthedocs.io/en/stable/handbook/concepts.html#concept-modes</a></p>
</aside>
<aside class="footnote brackets" id="fn14" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id14">14</a><span class="fn-bracket">]</span></span>
<p>Remember what VS Code said when we asked it to open the file named `cosmo`? The file “is either a binary or ….” VS Code was telling us that it was a file full of binary numbers that don’t represent any text encoding. Those numbers encode some kind of information, but not something that is entirely text! In our case, this other kind of information was an image file.</p>
</aside>
<aside class="footnote brackets" id="fn15" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id15">15</a><span class="fn-bracket">]</span></span>
<p>This is a bit (pun intended) of a trick question. The answer is neither. If we ignore the imprecision around 0 and 1, we similarly shouldn’t believe the small differences around 0.5. Furthermore, if a signal is measured close to the value that represents neither a digital 0 nor a digital 1, it means we have some type of error in our digital system.</p>
</aside>
<aside class="footnote brackets" id="fn16" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id16">16</a><span class="fn-bracket">]</span></span>
<p>It’s not really magic, but we won’t dive below the digital abstraction in this book. If you’re interested, take a digital design course to learn exactly how this is done.</p>
</aside>
<aside class="footnote brackets" id="fn17" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id17">17</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://pillow.readthedocs.io/en/stable/handbook/concepts.html#concept-modes">https://pillow.readthedocs.io/en/stable/handbook/concepts.html#concept-modes</a></p>
</aside>
<aside class="footnote brackets" id="fn18" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id18">18</a><span class="fn-bracket">]</span></span>
<p>I say “a little bit more than” because the 16 in 16 GB is rounded too.</p>
</aside>
<aside class="footnote brackets" id="fn19" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id19">19</a><span class="fn-bracket">]</span></span>
<p>The script carefully avoids allowing the sliding window to slip outside the bounds of the original image by playing with the range of the indices in the nested for-loops.</p>
</aside>
<aside class="footnote brackets" id="fn20" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id20">20</a><span class="fn-bracket">]</span></span>
<p>Although pixels in an 8-bit, grayscale image are limited to values between 0 and 255, the PIL returns a Python integer object to us when we apply an index to the `pixels` object, which allows us to compute a number like -765. Saturation occurs when we attempt to store -765 in `fpixels[i,j]`.</p>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="chap05.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 5: Play Guess-a-number</p>
      </div>
    </a>
    <a class="right-next"
       href="chap07.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 7: Many But Not Any Number</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numbers-and-knowledge">Numbers and knowledge</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#do-you-see-my-dog">Do you see my dog?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#no-interpretation-please">No interpretation, please</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-a-hexdump">Reading a hexdump</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hexadecimal-explained">Hexadecimal explained</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-between-number-systems">Converting between number systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#does-the-computer-see-my-dog">Does the computer see my dog?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#painting-a-picture">Painting a picture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bits">Bits</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-finger-no-thumb">One finger, no thumb</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-digital-abstraction">The digital abstraction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bits-bytes-and-nibbles">Bits, bytes, and nibbles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-a-pixel-s-color">Setting a pixel’s color</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saturation">Saturation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overflow-and-underflow">Overflow and Underflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-edges">Finding edges</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mike Smith
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023 by Michael D. Smith. All rights reserved.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>